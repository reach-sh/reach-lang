version: '3.4'
x-client-env: &client-env
  environment:
    - REACH_DEBUG
    - REACH_RPC_SERVER=host.docker.internal
    - REACH_RPC_PORT=3000
    - REACH_RPC_KEY
    - REACH_RPC_TLS_REJECT_UNVERIFIED=0
  extra_hosts:
    - 'host.docker.internal:172.17.0.1'
services:
  client-js: &client-js
    image: reachsh/reach-app-tut-7-rpc-client-js:latest
  client-py: &client-py
    image: reachsh/reach-app-tut-7-rpc-client-py:latest
  client-go: &client-go
    image: reachsh/reach-app-tut-7-rpc-client-go:latest
  client: &client
    <<: *client-js
  reach-app-tut-7-rpc:
    <<: *client
    environment:
      - REACH_RPC_SERVER=reach-app-tut-7-rpc-server
      - REACH_RPC_PORT=3000
      - REACH_RPC_KEY=INSERT-YOUR-OWN-PRESHARED-KEY

      # The following is highly insecure in Real Lifeâ„¢ applications and must
      # only be used under controlled conditions (such as during development)
      #   See:
      # https://nodejs.org/api/cli.html#cli_node_tls_reject_unauthorized_value
      # https://2.python-requests.org/en/master/user/advanced/#ssl-cert-verification
      # https://golang.org/pkg/crypto/tls/#Config
      - REACH_RPC_TLS_REJECT_UNVERIFIED=0 # Default "on"
  client-only:
    <<: *client
    <<: *client-env
  client-js-only:
    <<: *client-js
    <<: *client-env
  client-py-only:
    <<: *client-py
    <<: *client-env
  client-go-only:
    <<: *client-go
    <<: *client-env
