[{"bookPath":"guide","title":"How should I test a DApp?","titleId":"guide-testing","hasOtp":true,"hasPageHeader":true},"<p><i id=\"p_0\" class=\"pid\"></i>When you are writing a DApp in Reach, you should test it thoroughly.<a href=\"#p_0\" class=\"pid\">0</a></p>\n<p>\n  <i id=\"p_1\" class=\"pid\"></i>You may think that because Reach has a verification engine you don't need to write tests.\n  This is incorrect:\n  The general verification checks that Reach performs ensure that your program does not do obviously bad things, like violate the linearity of tokens, but it does not check that you wrote the correct program.\n  Furthermore, the specific verification checks that Reach allows you to write cannot specify every bad thing you want to avoid or every good thing that you want to happen.\n  Therefore, you need to use a variety of quality assurance mechanisms.<a href=\"#p_1\" class=\"pid\">1</a>\n</p>\n<p><i id=\"p_2\" class=\"pid\"></i>Your general philosophy for thinking about testing is that you write the program multiple times and make sure that each time you write the program, you write the same program:<a href=\"#p_2\" class=\"pid\">2</a></p>\n<ol>\n  <li><i id=\"p_3\" class=\"pid\"></i>You write the program in Reach.<a href=\"#p_3\" class=\"pid\">3</a></li>\n  <li><i id=\"p_4\" class=\"pid\"></i>You write the program in Reach's <span class=\"snip\"><a href=\"/rsh/compute/#rsh_assert\" title=\"rsh: assert\"><span style=\"color: var(--shiki-color-text)\">assert</span></a></span> and <span class=\"snip\"><a href=\"/rsh/consensus/#rsh_invariant\" title=\"rsh: invariant\"><span style=\"color: var(--shiki-color-text)\">invariant</span></a></span> forms.<a href=\"#p_4\" class=\"pid\">4</a></li>\n  <li><i id=\"p_5\" class=\"pid\"></i>You write the program with an automated JavaScript test suite.<a href=\"#p_5\" class=\"pid\">5</a></li>\n  <li><i id=\"p_6\" class=\"pid\"></i>You write the program with an interactive user interface.<a href=\"#p_6\" class=\"pid\">6</a></li>\n  <li><i id=\"p_7\" class=\"pid\"></i>You write the program with an automated test suite over that user interface.<a href=\"#p_7\" class=\"pid\">7</a></li>\n</ol>\n<p>\n  <i id=\"p_8\" class=\"pid\"></i>The connection between any of these two versions of the program is good if whenever you change one, the other one breaks and detects the change.\n  For example, if you change the program (#1) to use a non-network token, rather than the network token, then your test suite (#3) should reflect this, because your testing accounts will need to get a balance of this non-network token.<a href=\"#p_8\" class=\"pid\">8</a>\n</p>\n<p>\n  <i id=\"p_9\" class=\"pid\"></i>Reach provides tools for writing #1, #2, and #3.\n  You don't have to use our tool for #3 (<span class=\"snip\"><a href=\"/frontend/#js_test\" title=\"js: test\"><span style=\"color: var(--shiki-color-text)\">test</span></a></span>) and could use any testing framework you wanted.\n  We don't provide tools for #4 or #5 and you can use any user interface toolkit or testing regime; we like to use React for #4 and Cypress for #5.<a href=\"#p_9\" class=\"pid\">9</a>\n</p>\n<p><i id=\"p_10\" class=\"pid\"></i>At the micro-level, your testing outlook should be that tests either:<a href=\"#p_10\" class=\"pid\">10</a></p>\n<ol>\n  <li><i id=\"p_11\" class=\"pid\"></i>Establish that something bad does not happen. Or,<a href=\"#p_11\" class=\"pid\">11</a></li>\n  <li><i id=\"p_12\" class=\"pid\"></i>Establish that something good does happen.<a href=\"#p_12\" class=\"pid\">12</a></li>\n</ol>\n<p>\n  <i id=\"p_13\" class=\"pid\"></i>In order to build a large number of these tests succinctly, you should build a simple \"library\" that can succinctly initialize your DApp and then run a scenario.\n  Like this:<a href=\"#p_13\" class=\"pid\">13</a>\n</p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"const runScenario = async (go) => {\n  // Set up the DApp\n  const tok = ....;\n  const ctc = ....;\n  // Deploy it\n  await .... ctc.p.Deploy ...\n  const ctcInfo = await ctc.getInfo();\n  // Run a particular test\n  await go({\n    ctcInfo,\n  });\n};\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const\" title=\"js: const\"><span style=\"color: var(--shiki-token-keyword)\">const</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-function)\">runScenario</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">=</span><span style=\"color: var(--shiki-color-text)\"> </span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\" title=\"js: async\"><span style=\"color: var(--shiki-token-keyword)\">async</span></a><span style=\"color: var(--shiki-color-text)\"> (go) </span><span style=\"color: var(--shiki-token-keyword)\">=&gt;</span><span style=\"color: var(--shiki-color-text)\"> {</span></li><li value=\"2\"><span style=\"color: var(--shiki-color-text)\">  </span><span style=\"color: var(--shiki-token-comment)\">// Set up the DApp</span></li><li value=\"3\"><span style=\"color: var(--shiki-color-text)\">  </span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const\" title=\"js: const\"><span style=\"color: var(--shiki-token-keyword)\">const</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-constant)\">tok</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">=</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">...</span><span style=\"color: var(--shiki-color-text)\">.;</span></li><li value=\"4\"><span style=\"color: var(--shiki-color-text)\">  </span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const\" title=\"js: const\"><span style=\"color: var(--shiki-token-keyword)\">const</span></a><span style=\"color: var(--shiki-color-text)\"> </span><a href=\"/frontend/#js_ctc\" title=\"js: ctc\"><span style=\"color: var(--shiki-token-constant)\">ctc</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">=</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">...</span><span style=\"color: var(--shiki-color-text)\">.;</span></li><li value=\"5\"><span style=\"color: var(--shiki-color-text)\">  </span><span style=\"color: var(--shiki-token-comment)\">// Deploy it</span></li><li value=\"6\"><span style=\"color: var(--shiki-color-text)\">  </span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\" title=\"js: await\"><span style=\"color: var(--shiki-token-keyword)\">await</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">...</span><span style=\"color: var(--shiki-color-text)\">. </span><a href=\"/frontend/#js_ctc\" title=\"js: ctc\"><span style=\"color: var(--shiki-token-constant)\">ctc</span></a><span style=\"color: var(--shiki-color-text)\">.</span><a href=\"/frontend/#js_ctc.p\" title=\"js: ctc.p\"><span style=\"color: var(--shiki-token-constant)\">p</span></a><span style=\"color: var(--shiki-color-text)\">.Deploy </span><span style=\"color: var(--shiki-token-keyword)\">...</span></li><li value=\"7\"><span style=\"color: var(--shiki-color-text)\">  </span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const\" title=\"js: const\"><span style=\"color: var(--shiki-token-keyword)\">const</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-constant)\">ctcInfo</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">=</span><span style=\"color: var(--shiki-color-text)\"> </span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\" title=\"js: await\"><span style=\"color: var(--shiki-token-keyword)\">await</span></a><span style=\"color: var(--shiki-color-text)\"> </span><a href=\"/frontend/#js_ctc\" title=\"js: ctc\"><span style=\"color: var(--shiki-token-constant)\">ctc</span></a><a href=\"/frontend/#js_getInfo\" title=\"js: getInfo\"><span style=\"color: var(--shiki-token-function)\">.getInfo</span></a><span style=\"color: var(--shiki-color-text)\">();</span></li><li value=\"8\"><span style=\"color: var(--shiki-color-text)\">  </span><span style=\"color: var(--shiki-token-comment)\">// Run a particular test</span></li><li value=\"9\"><span style=\"color: var(--shiki-color-text)\">  </span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\" title=\"js: await\"><span style=\"color: var(--shiki-token-keyword)\">await</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-function)\">go</span><span style=\"color: var(--shiki-color-text)\">({</span></li><li value=\"10\"><span style=\"color: var(--shiki-color-text)\">    ctcInfo</span><span style=\"color: var(--shiki-token-punctuation)\">,</span></li><li value=\"11\"><span style=\"color: var(--shiki-color-text)\">  });</span></li><li value=\"12\"><span style=\"color: var(--shiki-color-text)\">};</span></li></ol></pre>\n<p><i id=\"p_14\" class=\"pid\"></i>Then, you can write lots of different scenarios:<a href=\"#p_14\" class=\"pid\">14</a></p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"await runScenario(async ({ctcInfo}) => {\n  // Test 1\n});\n\nawait runScenario(async ({ctcInfo}) => {\n  // Test 2\n});\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\" title=\"js: await\"><span style=\"color: var(--shiki-token-keyword)\">await</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-function)\">runScenario</span><span style=\"color: var(--shiki-color-text)\">(</span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\" title=\"js: async\"><span style=\"color: var(--shiki-token-keyword)\">async</span></a><span style=\"color: var(--shiki-color-text)\"> ({ctcInfo}) </span><span style=\"color: var(--shiki-token-keyword)\">=&gt;</span><span style=\"color: var(--shiki-color-text)\"> {</span></li><li value=\"2\"><span style=\"color: var(--shiki-color-text)\">  </span><span style=\"color: var(--shiki-token-comment)\">// Test 1</span></li><li value=\"3\"><span style=\"color: var(--shiki-color-text)\">});</span></li><li value=\"4\"></li><li value=\"5\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\" title=\"js: await\"><span style=\"color: var(--shiki-token-keyword)\">await</span></a><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-function)\">runScenario</span><span style=\"color: var(--shiki-color-text)\">(</span><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\" title=\"js: async\"><span style=\"color: var(--shiki-token-keyword)\">async</span></a><span style=\"color: var(--shiki-color-text)\"> ({ctcInfo}) </span><span style=\"color: var(--shiki-token-keyword)\">=&gt;</span><span style=\"color: var(--shiki-color-text)\"> {</span></li><li value=\"6\"><span style=\"color: var(--shiki-color-text)\">  </span><span style=\"color: var(--shiki-token-comment)\">// Test 2</span></li><li value=\"7\"><span style=\"color: var(--shiki-color-text)\">});</span></li></ol></pre>\n<p>\n  <i id=\"p_15\" class=\"pid\"></i>The <span class=\"snip\"><a href=\"/frontend/#js_test\" title=\"js: test\"><span style=\"color: var(--shiki-token-constant)\">test</span></a><a href=\"/frontend/#js_test.one\" title=\"js: test.one\"><span style=\"color: var(--shiki-color-text)\">.one</span></a></span> function is designed for being used in contexts like this.\n  Then you can use <span class=\"snip\"><a href=\"/frontend/#js_test\" title=\"js: test\"><span style=\"color: var(--shiki-token-constant)\">test</span></a><a href=\"/frontend/#js_test.run\" title=\"js: test.run\"><span style=\"color: var(--shiki-color-text)\">.run</span></a></span> and command-line arguments to select a particular test to run while developing.<a href=\"#p_15\" class=\"pid\">15</a>\n</p>\n<p>\n  <i id=\"p_16\" class=\"pid\"></i>Finally, you should use \"standard\" software testing and quality assurance practices, like continuous integration.\n  Wikipedia has a great article on <a href=\"https://en.wikipedia.org/wiki/Software_testing\">Software Testing</a> that is a good place to get started finding more resources.<a href=\"#p_16\" class=\"pid\">16</a>\n</p>","<ul><li class=\"dynamic\"><a href=\"#guide-testing\">How should I test a DApp?</a></li></ul>"]