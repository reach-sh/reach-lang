<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2&nbsp;Scaffolding and Setup</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Pay-<wbr></wbr>To-<wbr></wbr>Play Tic-<wbr></wbr>Tac-<wbr></wbr>Toe Tutorial</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="tic-tac-0.html" class="tocviewlink" data-pltdoc="x">Install and Initialize</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Scaffolding and Setup</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="tic-tac-2.html" class="tocviewlink" data-pltdoc="x">Tic-<wbr></wbr>Tac-<wbr></wbr>Toe</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="tic-tac-3.html" class="tocviewlink" data-pltdoc="x">Pay-<wbr></wbr>to-<wbr></wbr>Play</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="tic-tac-5.html" class="tocviewlink" data-pltdoc="x">Timeouts and Participation</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="tic-tac-6.html" class="tocviewlink" data-pltdoc="x">Interaction and Independence</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="tic-tac-7.html" class="tocviewlink" data-pltdoc="x">Web Interaction</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="algo.html" class="tocviewlink" data-pltdoc="x">Running on Algorand</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="trouble.html" class="tocviewlink" data-pltdoc="x">Troubleshooting</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tic-tac-0.html" title="backward to &quot;1 Install and Initialize&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pay-To-Play Tic-Tac-Toe Tutorial&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="tic-tac-2.html" title="forward to &quot;3 Tic-Tac-Toe&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>2<tt>&nbsp;</tt><a name="(part._tic-tac-1)"></a>Scaffolding and Setup</h3><p>In this tutorial, we&rsquo;ll be building a version of Tic-Tac-Toe where two players, <span class="emph">Alice</span> and <span class="emph">Bob</span>, can wager on the result of the game.
We&rsquo;ll start simple and slowly make the application more full-featured.</p><p>You should follow along by copying each part of the program and seeing how things go.
You may find it beneficial to type each line out, rather than copying &amp; pasting so you can start building your muscle memory and begin to get a sense for each part of a Reach program.</p><p>Let&rsquo;s start by creating a file named <span class="stt">index.rsh</span>.
It doesn&rsquo;t matter where you put this file, but we recommend putting in the current directory, which would be <span class="stt">~/reach/tic-tac</span> if you&rsquo;re following along exactly.
In all the subsequent code samples, we&rsquo;ll label the files based on the chapter of the tutorial you&rsquo;re reading.
For example, start off by typing the following into <span class="stt">index.rsh</span>:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-1/index.rsh"><span class="stt">tic-tac-1/index.rsh</span></a><button class="btn" data-clipboard-text="'reach 0.1';

export const main =
  Reach.App(
    {},
    [Participant('Alice', {}), Participant('Bob', {})],
    (A, B) =&gt; {
      exit(); });"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span> <span class="mi">1</span>    <span class="s1">&#39;reach 0.1&#39;</span><span class="p">;</span>
 <span class="mi">2</span>    
 <span class="mi">3</span>    <font class="badlink"><span class="kd">export</span></font> <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">main</span></font> <font class="badlink"><span class="o">=</span></font>
 <span class="mi">4</span>      <font class="badlink"><span class="nb">Reach</span></font><span class="p">.</span><font class="badlink"><span class="nb">App</span></font><span class="p">(</span>
 <span class="mi">5</span>        <span class="p">{},</span>
 <span class="mi">6</span>        <span class="p">[</span><font class="badlink"><span class="nb">Participant</span></font><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="p">{}),</span> <font class="badlink"><span class="nb">Participant</span></font><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="p">{})],</span>
 <span class="mi">7</span>        <span class="p">(</span><font class="badlink"><span class="nx">A</span></font><span class="p">,</span> <font class="badlink"><span class="nx">B</span></font><span class="p">)</span> <font class="badlink"><span class="o">=&gt;</span></font> <span class="p">{</span>
 <span class="mi">8</span>          <font class="badlink"><span class="k">exit</span></font><span class="p">();</span> <span class="p">});</span>
</pre></div></div></p><p>This is just a shell of a program that doesn&rsquo;t do much, but it has a few important components.</p><ul><li><p>Line 1 indicates that this is a Reach program.
You&rsquo;ll always have this at the top of every program.</p></li><li><p>Line 3 defines the main export from the program.
When you compile, this is what the compiler will look at.</p></li><li><p>Line 6 specifies the two participants to this application, <span class="emph">Alice</span> and <span class="emph">Bob</span>.</p></li></ul><p>Before we go too much further, let&rsquo;s create a similar shell for our JavaScript <font class="badlink"><span class="techoutside"><span class="techinside">frontend</span></span></font> code.
Open a new file named <span class="stt">index.mjs</span> and fill it with this:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-1/index.mjs"><span class="stt">tic-tac-1/index.mjs</span></a><button class="btn" data-clipboard-text="import { loadStdlib } from '@reach-sh/stdlib';
import * as backend from './build/index.main.mjs';

(async () =&gt; {
  const stdlib = await loadStdlib();
  const startingBalance = stdlib.parseCurrency(10);

  const accAlice = await stdlib.newTestAccount(startingBalance);
  const accBob = await stdlib.newTestAccount(startingBalance);

  const ctcAlice = accAlice.deploy(backend);
  const ctcBob = accBob.attach(backend, ctcAlice.getInfo());

  await Promise.all([
    backend.Alice(
      ctcAlice,
      {},
    ),
    backend.Bob(
      ctcBob,
      {},
    ),
  ]);
})(); // &lt;-- Don't forget these!"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span> <span class="mi">1</span>    <font class="badlink"><span class="kr">import</span></font> <span class="p">{</span> <font class="badlink"><span class="nx">loadStdlib</span></font> <span class="p">}</span> <font class="badlink"><span class="nx">from</span></font> <span class="s1">&#39;@reach-sh/stdlib&#39;</span><span class="p">;</span>
 <span class="mi">2</span>    <font class="badlink"><span class="kr">import</span></font> <font class="badlink"><span class="o">*</span></font> <font class="badlink"><span class="nx">as</span></font> <font class="badlink"><span class="nx">backend</span></font> <font class="badlink"><span class="nx">from</span></font> <span class="s1">&#39;./build/index.main.mjs&#39;</span><span class="p">;</span>
 <span class="mi">3</span>    
 <span class="mi">4</span>    <span class="p">(</span><font class="badlink"><span class="nx">async</span></font> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
 <span class="mi">5</span>      <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">stdlib</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">loadStdlib</span></font><span class="p">();</span>
 <span class="mi">6</span>      <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">startingBalance</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">parseCurrency</span></font><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
 <span class="mi">7</span>    
 <span class="mi">8</span>      <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">accAlice</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">newTestAccount</span></font><span class="p">(</span><font class="badlink"><span class="nx">startingBalance</span></font><span class="p">);</span>
 <span class="mi">9</span>      <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">accBob</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">newTestAccount</span></font><span class="p">(</span><font class="badlink"><span class="nx">startingBalance</span></font><span class="p">);</span>
<span class="mi">10</span>    
<span class="mi">11</span>      <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">ctcAlice</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">accAlice</span></font><span class="p">.</span><font class="badlink"><span class="nx">deploy</span></font><span class="p">(</span><font class="badlink"><span class="nx">backend</span></font><span class="p">);</span>
<span class="mi">12</span>      <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">ctcBob</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">accBob</span></font><span class="p">.</span><font class="badlink"><span class="nx">attach</span></font><span class="p">(</span><font class="badlink"><span class="nx">backend</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ctcAlice</span></font><span class="p">.</span><font class="badlink"><span class="nx">getInfo</span></font><span class="p">());</span>
<span class="mi">13</span>    
<span class="mi">14</span>      <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">.</span><font class="badlink"><span class="nx">all</span></font><span class="p">([</span>
<span class="mi">15</span>        <font class="badlink"><span class="nx">backend</span></font><span class="p">.</span><font class="badlink"><span class="nx">Alice</span></font><span class="p">(</span>
<span class="mi">16</span>          <font class="badlink"><span class="nx">ctcAlice</span></font><span class="p">,</span>
<span class="mi">17</span>          <span class="p">{},</span>
<span class="mi">18</span>        <span class="p">),</span>
<span class="mi">19</span>        <font class="badlink"><span class="nx">backend</span></font><span class="p">.</span><font class="badlink"><span class="nx">Bob</span></font><span class="p">(</span>
<span class="mi">20</span>          <font class="badlink"><span class="nx">ctcBob</span></font><span class="p">,</span>
<span class="mi">21</span>          <span class="p">{},</span>
<span class="mi">22</span>        <span class="p">),</span>
<span class="mi">23</span>      <span class="p">]);</span>
<span class="mi">24</span>    <span class="p">})();</span> <span class="c1">// &lt;-- Don&#39;t forget these!</span>
</pre></div></div></p><p>This JavaScript code is similarly schematic and will be consistent across all of your test programs.</p><ul><li><p>Line 1 imports the Reach standard library loader.</p></li><li><p>Line 2 imports your backend, which <span class="stt">./reach compile</span> will produce.</p></li><li><p>Line 4 defines an asynchronous function that will be the body of our frontend.</p></li><li><p>Line 5 loads the standard library dynamically based on the <span class="stt">REACH_CONNECTOR_MODE</span> environment variable.</p></li><li><p>Line 6 defines a quantity of <font class="badlink"><span class="techoutside"><span class="techinside">network token</span></span></font>s as the starting balance for each test account.</p></li><li><p>Lines 8 and 9 create test accounts with initial endowments for Alice and Bob.
This will only work on the Reach-provided developer testing network.</p></li><li><p>Line 11 has Alice deploy the application.</p></li><li><p>Line 12 has Bob attach to it.</p></li><li><p>Lines 15 through 18 initialize Alice&rsquo;s backend.</p></li><li><p>Lines 19 through 22 initialize Bob&rsquo;s backend.</p></li><li><p>Line 14 waits for the backends to complete.</p></li><li><p>Line 24 calls this asynchronous function that we&rsquo;ve defined.</p></li></ul><p>This is now enough for Reach to compile and run our program. Let&rsquo;s try by running</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">./reach run</span></p><p>Reach should now build and launch a Docker container for this application.
Since the application doesn&rsquo;t do anything, you&rsquo;ll just see a lot of diagnostic messages though, so that&rsquo;s not very exciting.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The entire process that we just went through can be automated by running <span class="stt">./reach init</span> when you start your next project!</p></blockquote></blockquote></blockquote><p>In <a href="tic-tac-2.html" data-pltdoc="x">the next step</a>, we&rsquo;ll implement the logic of Tic-Tac-Toe and our application will start doing something!</p><p><a href="index.html" data-pltdoc="x">Main menu</a></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tic-tac-0.html" title="backward to &quot;1 Install and Initialize&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pay-To-Play Tic-Tac-Toe Tutorial&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="tic-tac-2.html" title="forward to &quot;3 Tic-Tac-Toe&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>