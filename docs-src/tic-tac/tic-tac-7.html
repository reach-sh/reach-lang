<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>7&nbsp;Web Interaction</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="figure.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="figure.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Pay-<wbr></wbr>To-<wbr></wbr>Play Tic-<wbr></wbr>Tac-<wbr></wbr>Toe Tutorial</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="tic-tac-0.html" class="tocviewlink" data-pltdoc="x">Install and Initialize</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="tic-tac-1.html" class="tocviewlink" data-pltdoc="x">Scaffolding and Setup</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="tic-tac-2.html" class="tocviewlink" data-pltdoc="x">Tic-<wbr></wbr>Tac-<wbr></wbr>Toe</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="tic-tac-3.html" class="tocviewlink" data-pltdoc="x">Pay-<wbr></wbr>to-<wbr></wbr>Play</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="tic-tac-5.html" class="tocviewlink" data-pltdoc="x">Timeouts and Participation</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="tic-tac-6.html" class="tocviewlink" data-pltdoc="x">Interaction and Independence</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Web Interaction</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="algo.html" class="tocviewlink" data-pltdoc="x">Running on Algorand</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="trouble.html" class="tocviewlink" data-pltdoc="x">Troubleshooting</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tic-tac-6.html" title="backward to &quot;6 Interaction and Independence&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pay-To-Play Tic-Tac-Toe Tutorial&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="algo.html" title="forward to &quot;8 Running on Algorand&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>7<tt>&nbsp;</tt><a name="(part._tic-tac-7)"></a>Web Interaction</h3><p>In the last section, we made Tic-Tac-Toe run as a command-line application, without any changes to the Reach program.
In this section, we again won&rsquo;t be making any changes to the Reach program.
Instead, we&rsquo;ll replace the command-line interface with a Web interface.</p><p>We will use <a href="https://reactjs.org/">React.js</a> for this tutorial, but the same principles apply to any Web framework.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><div class="SIntrapara">If you&rsquo;ve never used React before, here are some basics about how it works:
</div><div class="SIntrapara"><ul><li><p>React programs are JavaScript programs that use a special library that allows you to mix HTML inside of the body of your JavaScript.</p></li><li><p>React has a special compiler that combines a bundle of JavaScript programs, and all their dependencies, into one large file that can be deployed on a static Web server.
This is called "packing".</p></li><li><p>When you&rsquo;re developing and testing with React, you run a special development Web server that watches updates this packed file every time you modify your source files, so you don&rsquo;t have to constantly run the compiler.</p></li><li><p>Reach automates the process of starting this development server for you when you run <span class="stt">./reach react</span> and gives you access to it at <span class="stt">http://localhost:3000/</span>.</p></li></ul></div></p></blockquote></blockquote></blockquote><p>Similarly, in this tutorial, we assume that we will be deploying (and testing) with Ethereum.
Reach Web applications rely on the Web browser to provide access to a consensus network account and its associated wallet.
On Ethereum, the standard wallet is <a href="https://metamask.io">MetaMask</a>.
If you want to test this code, you&rsquo;ll need to install it and set it up.
Furthermore, MetaMask does not support multiple active accounts, so if you want to test Tic-Tac-Toe locally, you&rsquo;ll need to have two separate browser instances: one to act as Alice and another to act as Bob.</p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>The code in this section does not use the scaffolding from the previous section.
Reach comes with a convenience command for deleting scaffolded files:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">./reach unscaffold</span></p><p>Similarly, you do not need the previous <span class="stt">index.mjs</span> file, because we&rsquo;ll be writing it completely from scratch to use React.
You can run the following command to delete it:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">rm index.mjs</span></p><p>Or, you can copy the <span class="stt">index.rsh</span> file into a new directory and work from there.</p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>This code is supplemented with <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.css">index.css</a>
and some <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views">views</a>.
These details are not specific to Reach, and are fairly trivial,
so we will not explain the specifics of those files.
If you run this locally, you&rsquo;ll want to download those files.
Your directory should look like:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">.</span></p></td></tr><tr><td><p><span class="stt">&#9500;&#9472;&#9472; index.css</span></p></td></tr><tr><td><p><span class="stt">&#9500;&#9472;&#9472; index.js</span></p></td></tr><tr><td><p><span class="stt">&#9500;&#9472;&#9472; index.rsh</span></p></td></tr><tr><td><p><span class="stt">&#9492;&#9472;&#9472; views</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; AppViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; AttacherViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; DeployerViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; PlayerViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9492;&#9472;&#9472; render.js</span></p></td></tr></table></p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>We will focus on <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js"><span class="stt">tic-tac-7/index.js</span></a>,
because <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.rsh"><span class="stt">tic-tac-7/index.rsh</span></a> is the same as previous sections.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js#L1-L9"><span class="stt">tic-tac-7/index.js</span></a><button class="btn" data-clipboard-text="import React from &quot;react&quot;;
import AppViews from &quot;./views/AppViews&quot;;
import DeployerViews from &quot;./views/DeployerViews&quot;;
import AttacherViews from &quot;./views/AttacherViews&quot;;
import {renderDOM, renderView} from &quot;./views/render&quot;;
import &quot;./index.css&quot;;
import * as backend from &quot;./build/index.main.mjs&quot;;
import * as reach from &quot;@reach-sh/stdlib/ETH&quot;;
"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span>  <span class="mi">1</span>    <font class="badlink"><span class="kr">import</span></font> <font class="badlink"><span class="nx">React</span></font> <font class="badlink"><span class="nx">from</span></font> <span class="s2">"react"</span><span class="p">;</span>
  <span class="mi">2</span>    <font class="badlink"><span class="kr">import</span></font> <font class="badlink"><span class="nx">AppViews</span></font> <font class="badlink"><span class="nx">from</span></font> <span class="s2">"./views/AppViews"</span><span class="p">;</span>
  <span class="mi">3</span>    <font class="badlink"><span class="kr">import</span></font> <font class="badlink"><span class="nx">DeployerViews</span></font> <font class="badlink"><span class="nx">from</span></font> <span class="s2">"./views/DeployerViews"</span><span class="p">;</span>
  <span class="mi">4</span>    <font class="badlink"><span class="kr">import</span></font> <font class="badlink"><span class="nx">AttacherViews</span></font> <font class="badlink"><span class="nx">from</span></font> <span class="s2">"./views/AttacherViews"</span><span class="p">;</span>
  <span class="mi">5</span>    <font class="badlink"><span class="kr">import</span></font> <span class="p">{</span><font class="badlink"><span class="nx">renderDOM</span></font><span class="p">,</span> <font class="badlink"><span class="nx">renderView</span></font><span class="p">}</span> <font class="badlink"><span class="nx">from</span></font> <span class="s2">"./views/render"</span><span class="p">;</span>
  <span class="mi">6</span>    <font class="badlink"><span class="kr">import</span></font> <span class="s2">"./index.css"</span><span class="p">;</span>
  <span class="mi">7</span>    <font class="badlink"><span class="kr">import</span></font> <font class="badlink"><span class="o">*</span></font> <font class="badlink"><span class="nx">as</span></font> <font class="badlink"><span class="nx">backend</span></font> <font class="badlink"><span class="nx">from</span></font> <span class="s2">"./build/index.main.mjs"</span><span class="p">;</span>
  <span class="mi">8</span>    <font class="badlink"><span class="kr">import</span></font> <font class="badlink"><span class="o">*</span></font> <font class="badlink"><span class="nx">as</span></font> <font class="badlink"><span class="nx">reach</span></font> <font class="badlink"><span class="nx">from</span></font> <span class="s2">"@reach-sh/stdlib/ETH"</span><span class="p">;</span>
  <span class="mi">9</span>    
<span class="p">...</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>On lines 1 thru 6, we import our view code and CSS.
On line 7, we import the compiled <code class="highlight"><font class="badlink"><span class="nx">backend</span></font></code>.
On line 8, we import the <code class="highlight"><font class="badlink"><span class="nx">stdlib</span></font></code> as <code class="highlight"><font class="badlink"><span class="nx">reach</span></font></code>.</p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>To run on Algorand, change the import on line 8.</p><p><code class="highlight"><font class="badlink"><span class="kd">import</span></font> <font class="badlink"><span class="o">*</span></font> <font class="badlink"><span class="kd">as</span></font> <font class="badlink"><span class="nx">reach</span></font> <font class="badlink"><span class="kd">from</span></font> <span class="s1">&#39;@reach-sh/stdlib/ALGO&#39;</span></code></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js#L10-L45"><span class="stt">tic-tac-7/index.js</span></a><button class="btn" data-clipboard-text="// currency default
const {standardUnit} = reach;

// If dev mode, use console.log(), else, don't
const dev = true;

// sleep function for delaying until move_made soud is played
const sleep = async (milliseconds) =&gt; await new Promise(resolve =&gt; setTimeout(resolve, milliseconds));

// convert keyboard numeric keypad input layout to reach back end
const handToInt = { // index to reach
    &quot;box7&quot;: 0,
    &quot;box8&quot;: 1,
    &quot;box9&quot;: 2,
    &quot;box4&quot;: 3,
    &quot;box5&quot;: 4,
    &quot;box6&quot;: 5,
    &quot;box1&quot;: 6,
    &quot;box2&quot;: 7,
    &quot;box3&quot;: 8
};

const intToHand = { // index to gameplay
    1: &quot;box7&quot;,
    2: &quot;box8&quot;,
    3: &quot;box9&quot;,
    4: &quot;box4&quot;,
    5: &quot;box5&quot;,
    6: &quot;box6&quot;,
    7: &quot;box1&quot;,
    8: &quot;box2&quot;,
    9: &quot;box3&quot;
};

const X_image = &quot;https://imgur.com/eBsDAXr.png&quot;;
const O_image = &quot;https://imgur.com/h1xuIW1.png&quot;;"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">...</span>    <span class="c1">// ...</span>
 <span class="mi">10</span>    <span class="c1">// currency default</span>
 <span class="mi">11</span>    <font class="badlink"><span class="kr">const</span></font> <span class="p">{</span><font class="badlink"><span class="nx">standardUnit</span></font><span class="p">}</span> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">;</span>
 <span class="mi">12</span>    
 <span class="mi">13</span>    <span class="c1">// If dev mode, use console.log(), else, don&#39;t</span>
 <span class="mi">14</span>    <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">dev</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="kc">true</span></font><span class="p">;</span>
 <span class="mi">15</span>    
 <span class="mi">16</span>    <span class="c1">// sleep function for delaying until move_made soud is played</span>
 <span class="mi">17</span>    <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">sleep</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">async</span></font> <span class="p">(</span><font class="badlink"><span class="nx">milliseconds</span></font><span class="p">)</span> <span class="p">=&gt;</span> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="k">new</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">(</span><font class="badlink"><span class="nx">resolve</span></font> <span class="p">=&gt;</span> <font class="badlink"><span class="nx">setTimeout</span></font><span class="p">(</span><font class="badlink"><span class="nx">resolve</span></font><span class="p">,</span> <font class="badlink"><span class="nx">milliseconds</span></font><span class="p">));</span>
 <span class="mi">18</span>    
 <span class="mi">19</span>    <span class="c1">// convert keyboard numeric keypad input layout to reach back end</span>
 <span class="mi">20</span>    <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">handToInt</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span> <span class="c1">// index to reach</span>
 <span class="mi">21</span>        <span class="s2">"box7"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">0</span><span class="p">,</span>
 <span class="mi">22</span>        <span class="s2">"box8"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">1</span><span class="p">,</span>
 <span class="mi">23</span>        <span class="s2">"box9"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">2</span><span class="p">,</span>
 <span class="mi">24</span>        <span class="s2">"box4"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">3</span><span class="p">,</span>
 <span class="mi">25</span>        <span class="s2">"box5"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">4</span><span class="p">,</span>
 <span class="mi">26</span>        <span class="s2">"box6"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">5</span><span class="p">,</span>
 <span class="mi">27</span>        <span class="s2">"box1"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">6</span><span class="p">,</span>
 <span class="mi">28</span>        <span class="s2">"box2"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">7</span><span class="p">,</span>
 <span class="mi">29</span>        <span class="s2">"box3"</span><font class="badlink"><span class="o">:</span></font> <span class="mi">8</span>
 <span class="mi">30</span>    <span class="p">};</span>
 <span class="mi">31</span>    
 <span class="mi">32</span>    <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">intToHand</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span> <span class="c1">// index to gameplay</span>
 <span class="mi">33</span>        <span class="mi">1</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box7"</span><span class="p">,</span>
 <span class="mi">34</span>        <span class="mi">2</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box8"</span><span class="p">,</span>
 <span class="mi">35</span>        <span class="mi">3</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box9"</span><span class="p">,</span>
 <span class="mi">36</span>        <span class="mi">4</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box4"</span><span class="p">,</span>
 <span class="mi">37</span>        <span class="mi">5</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box5"</span><span class="p">,</span>
 <span class="mi">38</span>        <span class="mi">6</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box6"</span><span class="p">,</span>
 <span class="mi">39</span>        <span class="mi">7</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box1"</span><span class="p">,</span>
 <span class="mi">40</span>        <span class="mi">8</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box2"</span><span class="p">,</span>
 <span class="mi">41</span>        <span class="mi">9</span><font class="badlink"><span class="o">:</span></font> <span class="s2">"box3"</span>
 <span class="mi">42</span>    <span class="p">};</span>
 <span class="mi">43</span>    
 <span class="mi">44</span>    <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">X_image</span></font> <font class="badlink"><span class="o">=</span></font> <span class="s2">"https://imgur.com/eBsDAXr.png"</span><span class="p">;</span>
 <span class="mi">45</span>    <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">O_image</span></font> <font class="badlink"><span class="o">=</span></font> <span class="s2">"https://imgur.com/h1xuIW1.png"</span><span class="p">;</span>
<span class="p">...</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>On these lines we define a few helpful constants and defaults for later,
some corresponding to the enumerations we defined in Reach.</p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">We start defining <code class="highlight"><font class="badlink"><span class="nx">App</span></font></code> as a React component,
and tell it what to do once it mounts, which is the React term for starting.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js#L55-L127"><span class="stt">tic-tac-7/index.js</span></a><button class="btn" data-clipboard-text="class App extends React.Component {
    // Starting screen, aka Connecting accounts
    constructor(props) {
        super(props);
        this.state = {
            view: &quot;ConnectAccount&quot;,
            ...defaults
        };
    }

    // When the player's account has connected, either ask them to fund their account or simply start the game
    async componentDidMount() {
        this.setState({
            view: &quot;Start&quot;
        });
    }

    async finalizeMount() {
        var acc = await reach.getDefaultAccount();
        if (dev) {
            console.log(acc)
        }
        const balAtomic = await reach.balanceOf(acc);
        const bal = reach.formatCurrency(balAtomic, 4);
        this.setState({
            acc,
            bal
        });
        try {
            const faucet = await reach.getFaucet();
            this.setState({
                view: &quot;FundAccount&quot;,
                faucet
            });
        } catch (e) {
            this.setState({
                view: &quot;DeployerOrAttacher&quot;
            });
        }
    }

    // Fund the given account and then start the game
    async fundAccount(fundAmount) {
        await reach.transfer(
            this.state.faucet,
            this.state.acc,
            reach.parseCurrency(fundAmount)
        );
        this.setState({
            view: &quot;DeployerOrAttacher&quot;
        });
    }

    // Skip funding the account and continue to the game
    async skipFundAccount() {
        this.setState({
            view: &quot;DeployerOrAttacher&quot;
        });
    }

    // HAve the user select if they want to be an attacher or a deployer
    selectAttacher() {
        this.setState({
            view: &quot;Wrapper&quot;,
            ContentView: Attacher
        });
    }
    selectDeployer() {
        this.setState({
            view: &quot;Wrapper&quot;,
            ContentView: Deployer
        });
    }"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">...</span>    <span class="c1">// ...</span>
 <span class="mi">55</span>    <font class="badlink"><span class="kr">class</span></font> <font class="badlink"><span class="nx">App</span></font> <font class="badlink"><span class="kr">extends</span></font> <font class="badlink"><span class="nx">React</span></font><span class="p">.</span><font class="badlink"><span class="nx">Component</span></font> <span class="p">{</span>
 <span class="mi">56</span>        <span class="c1">// Starting screen, aka Connecting accounts</span>
 <span class="mi">57</span>        <font class="badlink"><span class="nx">constructor</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">)</span> <span class="p">{</span>
 <span class="mi">58</span>            <font class="badlink"><span class="kr">super</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">);</span>
 <span class="mi">59</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
 <span class="mi">60</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"ConnectAccount"</span><span class="p">,</span>
 <span class="mi">61</span>                <span class="p">...</span><font class="badlink"><span class="nx">defaults</span></font>
 <span class="mi">62</span>            <span class="p">};</span>
 <span class="mi">63</span>        <span class="p">}</span>
 <span class="mi">64</span>    
 <span class="mi">65</span>        <span class="c1">// When the player&#39;s account has connected, either ask them to fund their account or simply start the game</span>
 <span class="mi">66</span>        <font class="badlink"><span class="nx">async</span></font> <font class="badlink"><span class="nx">componentDidMount</span></font><span class="p">()</span> <span class="p">{</span>
 <span class="mi">67</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
 <span class="mi">68</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Start"</span>
 <span class="mi">69</span>            <span class="p">});</span>
 <span class="mi">70</span>        <span class="p">}</span>
 <span class="mi">71</span>    
 <span class="mi">72</span>        <font class="badlink"><span class="nx">async</span></font> <font class="badlink"><span class="nx">finalizeMount</span></font><span class="p">()</span> <span class="p">{</span>
 <span class="mi">73</span>            <font class="badlink"><span class="kd">var</span></font> <font class="badlink"><span class="nx">acc</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">getDefaultAccount</span></font><span class="p">();</span>
 <span class="mi">74</span>            <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nx">dev</span></font><span class="p">)</span> <span class="p">{</span>
 <span class="mi">75</span>                <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><font class="badlink"><span class="nx">acc</span></font><span class="p">)</span>
 <span class="mi">76</span>            <span class="p">}</span>
 <span class="mi">77</span>            <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">balAtomic</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">balanceOf</span></font><span class="p">(</span><font class="badlink"><span class="nx">acc</span></font><span class="p">);</span>
 <span class="mi">78</span>            <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">bal</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">formatCurrency</span></font><span class="p">(</span><font class="badlink"><span class="nx">balAtomic</span></font><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
 <span class="mi">79</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
 <span class="mi">80</span>                <font class="badlink"><span class="nx">acc</span></font><span class="p">,</span>
 <span class="mi">81</span>                <font class="badlink"><span class="nx">bal</span></font>
 <span class="mi">82</span>            <span class="p">});</span>
 <span class="mi">83</span>            <font class="badlink"><span class="k">try</span></font> <span class="p">{</span>
 <span class="mi">84</span>                <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">faucet</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">getFaucet</span></font><span class="p">();</span>
 <span class="mi">85</span>                <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
 <span class="mi">86</span>                    <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"FundAccount"</span><span class="p">,</span>
 <span class="mi">87</span>                    <font class="badlink"><span class="nx">faucet</span></font>
 <span class="mi">88</span>                <span class="p">});</span>
 <span class="mi">89</span>            <span class="p">}</span> <font class="badlink"><span class="k">catch</span></font> <span class="p">(</span><font class="badlink"><span class="nx">e</span></font><span class="p">)</span> <span class="p">{</span>
 <span class="mi">90</span>                <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
 <span class="mi">91</span>                    <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"DeployerOrAttacher"</span>
 <span class="mi">92</span>                <span class="p">});</span>
 <span class="mi">93</span>            <span class="p">}</span>
 <span class="mi">94</span>        <span class="p">}</span>
 <span class="mi">95</span>    
 <span class="mi">96</span>        <span class="c1">// Fund the given account and then start the game</span>
 <span class="mi">97</span>        <font class="badlink"><span class="nx">async</span></font> <font class="badlink"><span class="nx">fundAccount</span></font><span class="p">(</span><font class="badlink"><span class="nx">fundAmount</span></font><span class="p">)</span> <span class="p">{</span>
 <span class="mi">98</span>            <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">transfer</span></font><span class="p">(</span>
 <span class="mi">99</span>                <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">faucet</span></font><span class="p">,</span>
<span class="mi">100</span>                <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">acc</span></font><span class="p">,</span>
<span class="mi">101</span>                <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">parseCurrency</span></font><span class="p">(</span><font class="badlink"><span class="nx">fundAmount</span></font><span class="p">)</span>
<span class="mi">102</span>            <span class="p">);</span>
<span class="mi">103</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">104</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"DeployerOrAttacher"</span>
<span class="mi">105</span>            <span class="p">});</span>
<span class="mi">106</span>        <span class="p">}</span>
<span class="mi">107</span>    
<span class="mi">108</span>        <span class="c1">// Skip funding the account and continue to the game</span>
<span class="mi">109</span>        <font class="badlink"><span class="nx">async</span></font> <font class="badlink"><span class="nx">skipFundAccount</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">110</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">111</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"DeployerOrAttacher"</span>
<span class="mi">112</span>            <span class="p">});</span>
<span class="mi">113</span>        <span class="p">}</span>
<span class="mi">114</span>    
<span class="mi">115</span>        <span class="c1">// HAve the user select if they want to be an attacher or a deployer</span>
<span class="mi">116</span>        <font class="badlink"><span class="nx">selectAttacher</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">117</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">118</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Wrapper"</span><span class="p">,</span>
<span class="mi">119</span>                <font class="badlink"><span class="nx">ContentView</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">Attacher</span></font>
<span class="mi">120</span>            <span class="p">});</span>
<span class="mi">121</span>        <span class="p">}</span>
<span class="mi">122</span>        <font class="badlink"><span class="nx">selectDeployer</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">123</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">124</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Wrapper"</span><span class="p">,</span>
<span class="mi">125</span>                <font class="badlink"><span class="nx">ContentView</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">Deployer</span></font>
<span class="mi">126</span>            <span class="p">});</span>
<span class="mi">127</span>        <span class="p">}</span>
<span class="p">...</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 60, we initialize the component state to display the <code class="highlight"><font class="badlink"><span class="nx">ConnectAccount</span></font></code> view (<font class="badlink">figure&nbsp;<span class="FigureRef">#f</span></font>).</p></li><li><p>On lines 66 thru 70, we hook into React&rsquo;s <code class="highlight"><font class="badlink"><span class="nx">componentDidMount</span></font></code> lifecycle event, which is called when the component starts.</p></li><li><p>On line 73, we use <code class="highlight"><font class="badlink"><span class="nx">getDefaultAccount</span></font></code>, which accesses the default browser account.</p><p>For example, when used with Ethereum, it can discover the currently-selected MetaMask account.</p></li><li><p>On line 84, we use <code class="highlight"><font class="badlink"><span class="nx">getFaucet</span></font></code> to try and access the Reach developer testing network faucet.</p></li><li><p>On line 86, if <code class="highlight"><font class="badlink"><span class="nx">getFaucet</span></font></code> was successful, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">FundAccount</span></font></code> view (<font class="badlink">figure&nbsp;<span class="FigureRef">#f</span></font>).</p></li><li><p>On line 91, if <code class="highlight"><font class="badlink"><span class="nx">getFaucet</span></font></code> was unsuccessful, we set the component state to skip to the <code class="highlight"><font class="badlink"><span class="nx">DeployerOrAttacher</span></font></code> view (<font class="badlink">figure&nbsp;<span class="FigureRef">#f</span></font>).</p></li><li><p>On lines 115 - 127, we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/AppViews.js"><span class="stt">tic-tac-7/views/AppViews.js</span></a>.</p></li></ul><p>Next, we will define <code class="highlight"><font class="badlink"><span class="nx">Player</span></font></code> as a React component,
which will be extended by the specialized components for Alice and Bob.</p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="GetHand.png" alt="" width="361" height="280"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Get.Hand))" x-target-lift="Figure"></a>Figure&nbsp;1: </span>The <code class="highlight"><font class="badlink"><span class="nx">GetHand</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/PlayerViews.js#L8-L32">PlayerViews.GetHand</a></span></p></blockquote><p>Our Web frontend needs to implement the <font class="badlink"><span class="techoutside"><span class="techinside">participant interact interface</span></span></font> for players, which we defined as:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.rsh#L73-L83"><span class="stt">tic-tac-7/index.rsh</span></a><button class="btn" data-clipboard-text="const Player =
      { ...hasRandom,
        getMove: Fun([State, Board], UInt),
        endsWith: Fun([State], Null),
        informTimeout: Fun([], Null) };
const Alice =
      { ...Player,
        wager: UInt };
const Bob =
      { ...Player,
        acceptWager: Fun([UInt], Null) };"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mi">73</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">Player</span></font> <font class="badlink"><span class="o">=</span></font>
<span class="mi">74</span>          <span class="p">{</span> <span class="p">...</span><font class="badlink"><span class="nb">hasRandom</span></font><span class="p">,</span>
<span class="mi">75</span>            <font class="badlink"><span class="nx">getMove</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nb">Fun</span></font><span class="p">([</span><font class="badlink"><span class="nx">State</span></font><span class="p">,</span> <font class="badlink"><span class="nx">Board</span></font><span class="p">],</span> <font class="badlink"><span class="nb">UInt</span></font><span class="p">),</span>
<span class="mi">76</span>            <font class="badlink"><span class="nx">endsWith</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nb">Fun</span></font><span class="p">([</span><font class="badlink"><span class="nx">State</span></font><span class="p">],</span> <font class="badlink"><span class="nb">Null</span></font><span class="p">),</span>
<span class="mi">77</span>            <font class="badlink"><span class="nx">informTimeout</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nb">Fun</span></font><span class="p">([],</span> <font class="badlink"><span class="nb">Null</span></font><span class="p">)</span> <span class="p">};</span>
<span class="mi">78</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">Alice</span></font> <font class="badlink"><span class="o">=</span></font>
<span class="mi">79</span>          <span class="p">{</span> <span class="p">...</span><font class="badlink"><span class="nx">Player</span></font><span class="p">,</span>
<span class="mi">80</span>            <font class="badlink"><span class="nx">wager</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nb">UInt</span></font> <span class="p">};</span>
<span class="mi">81</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">Bob</span></font> <font class="badlink"><span class="o">=</span></font>
<span class="mi">82</span>          <span class="p">{</span> <span class="p">...</span><font class="badlink"><span class="nx">Player</span></font><span class="p">,</span>
<span class="mi">83</span>            <font class="badlink"><span class="nx">acceptWager</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nb">Fun</span></font><span class="p">([</span><font class="badlink"><span class="nb">UInt</span></font><span class="p">],</span> <font class="badlink"><span class="nb">Null</span></font><span class="p">)</span> <span class="p">};</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>We will provide these callbacks via the React component directly.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js#L136-L241"><span class="stt">tic-tac-7/index.js</span></a><button class="btn" data-clipboard-text="class Player extends React.Component {
    // create the random function for the reach file to access
    random() {
        return reach.hasRandom.random();
    }
    // get the move the user wants to play
    async getHand(x, xs, os) { // bool(x) whether its X's turn
        // Present the buttons to the user so that they can actually select their move
        // hand is a box ID number relative to numeric keypad
        let valid = 1; // occupied
        let hand = null;
        

        while (valid &gt; 0) { // while occupied
            hand = await new Promise((resolveHandP) =&gt; {
                this.setState({
                    view: &quot;GetHand&quot;,
                    resolveHandP,
                    xs, // 1d array of 1's 0's; 1 = occupied by X
                    os // 1d array of 1's 0's; 1 = occupied by O
                });

                for (let i = 1; i &lt; 10; i++) {
                    if (dev) {
                        console.log(`${i} ${intToHand[i]} xs[i-1]=${parseInt(xs[i-1])} os[i-1]=${parseInt(os[i-1])}`);
                    }
                    if (parseInt(xs[i-1]) === 1) {
                        document.getElementById(intToHand[i]).src = X_image; 
                    }
                    if (parseInt(os[i-1]) === 1) {
                        document.getElementById(intToHand[i]).src = O_image;
                    }
            }
            });
            var blinger = document.getElementById(&quot;bling&quot;);
            blinger.play();

            valid = (
                parseInt(os[handToInt[hand]])
                + parseInt(xs[handToInt[hand]])
            ); // should return 1=occupied / 0=vacant
            if (dev) {
                console.log(`${valid}`);
            }

        };
        
        sleep(4000);

        if (dev) {
            console.log(`${os}`);
            console.log(`${xs}`);
        }
        
        // Display that a move as been accepted
        this.setState({
            view: &quot;GetHandb&quot;,
            playable: true
        });

        document.getElementById(hand).src = {
            x: X_image, 
            o: O_image,
        }[x ? &quot;x&quot; : &quot;o&quot;];

        if (dev) {
            console.log(`${hand}`);
        }
        for (let i = 1; i &lt; 10; i++) {
            if (dev) {
                console.log(`${i} ${intToHand[i]} xs[i-1]=${parseInt(xs[i-1])} os[i-1]=${parseInt(os[i-1])}`);
            }
            if (parseInt(xs[i-1]) === 1) {
                document.getElementById(intToHand[i]).src = X_image; 
            }
            if (parseInt(os[i-1]) === 1) {
                document.getElementById(intToHand[i]).src = O_image;
            }
        }

        // return the move
        return handToInt[hand];
    }

    // function to display who won
    endsWith(won, double, oppo, tie) {
        this.setState({
            view: &quot;Finale&quot;,
            won: won,
            double: double,
            tie: tie
        });
    }

    // Inform the players that a timeout has occurred
    informTimeout() {
        this.setState({
            view: &quot;Timeout&quot;
        });
    }

    // returns hand to Reach
    setImg(box_id) {
        this.state.resolveHandP(box_id);
    }
}"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">...</span>    <span class="c1">// ...</span>
<span class="mi">136</span>    <font class="badlink"><span class="kr">class</span></font> <font class="badlink"><span class="nx">Player</span></font> <font class="badlink"><span class="kr">extends</span></font> <font class="badlink"><span class="nx">React</span></font><span class="p">.</span><font class="badlink"><span class="nx">Component</span></font> <span class="p">{</span>
<span class="mi">137</span>        <span class="c1">// create the random function for the reach file to access</span>
<span class="mi">138</span>        <font class="badlink"><span class="nx">random</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">139</span>            <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">hasRandom</span></font><span class="p">.</span><font class="badlink"><span class="nx">random</span></font><span class="p">();</span>
<span class="mi">140</span>        <span class="p">}</span>
<span class="mi">141</span>        <span class="c1">// get the move the user wants to play</span>
<span class="mi">142</span>        <font class="badlink"><span class="nx">async</span></font> <font class="badlink"><span class="nx">getHand</span></font><span class="p">(</span><font class="badlink"><span class="nx">x</span></font><span class="p">,</span> <font class="badlink"><span class="nx">xs</span></font><span class="p">,</span> <font class="badlink"><span class="nx">os</span></font><span class="p">)</span> <span class="p">{</span> <span class="c1">// bool(x) whether its X&#39;s turn</span>
<span class="mi">143</span>            <span class="c1">// Present the buttons to the user so that they can actually select their move</span>
<span class="mi">144</span>            <span class="c1">// hand is a box ID number relative to numeric keypad</span>
<span class="mi">145</span>            <font class="badlink"><span class="kd">let</span></font> <font class="badlink"><span class="nx">valid</span></font> <font class="badlink"><span class="o">=</span></font> <span class="mi">1</span><span class="p">;</span> <span class="c1">// occupied</span>
<span class="mi">146</span>            <font class="badlink"><span class="kd">let</span></font> <font class="badlink"><span class="nx">hand</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="kc">null</span></font><span class="p">;</span>
<span class="mi">147</span>            
<span class="mi">148</span>    
<span class="mi">149</span>            <font class="badlink"><span class="k">while</span></font> <span class="p">(</span><font class="badlink"><span class="nx">valid</span></font> <font class="badlink"><span class="o">&gt;</span></font> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// while occupied</span>
<span class="mi">150</span>                <font class="badlink"><span class="nx">hand</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="k">new</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">((</span><font class="badlink"><span class="nx">resolveHandP</span></font><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="mi">151</span>                    <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">152</span>                        <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"GetHand"</span><span class="p">,</span>
<span class="mi">153</span>                        <font class="badlink"><span class="nx">resolveHandP</span></font><span class="p">,</span>
<span class="mi">154</span>                        <font class="badlink"><span class="nx">xs</span></font><span class="p">,</span> <span class="c1">// 1d array of 1&#39;s 0&#39;s; 1 = occupied by X</span>
<span class="mi">155</span>                        <font class="badlink"><span class="nx">os</span></font> <span class="c1">// 1d array of 1&#39;s 0&#39;s; 1 = occupied by O</span>
<span class="mi">156</span>                    <span class="p">});</span>
<span class="mi">157</span>    
<span class="mi">158</span>                    <font class="badlink"><span class="k">for</span></font> <span class="p">(</span><font class="badlink"><span class="kd">let</span></font> <font class="badlink"><span class="nx">i</span></font> <font class="badlink"><span class="o">=</span></font> <span class="mi">1</span><span class="p">;</span> <font class="badlink"><span class="nx">i</span></font> <font class="badlink"><span class="o">&lt;</span></font> <span class="mi">10</span><span class="p">;</span> <font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">++</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">159</span>                        <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nx">dev</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">160</span>                            <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`</span><span class="si">${</span><font class="badlink"><span class="nx">i</span></font><span class="si">}</span><span class="sb"> </span><span class="si">${</span><font class="badlink"><span class="nx">intToHand</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><span class="p">]</span><span class="si">}</span><span class="sb"> xs[i-1]=</span><span class="si">${</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">xs</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="sb"> os[i-1]=</span><span class="si">${</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">os</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="mi">161</span>                        <span class="p">}</span>
<span class="mi">162</span>                        <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">xs</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span> <font class="badlink"><span class="o">===</span></font> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">163</span>                            <font class="badlink"><span class="nb">document</span></font><span class="p">.</span><font class="badlink"><span class="nx">getElementById</span></font><span class="p">(</span><font class="badlink"><span class="nx">intToHand</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><span class="p">]).</span><font class="badlink"><span class="nx">src</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">X_image</span></font><span class="p">;</span> 
<span class="mi">164</span>                        <span class="p">}</span>
<span class="mi">165</span>                        <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">os</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span> <font class="badlink"><span class="o">===</span></font> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">166</span>                            <font class="badlink"><span class="nb">document</span></font><span class="p">.</span><font class="badlink"><span class="nx">getElementById</span></font><span class="p">(</span><font class="badlink"><span class="nx">intToHand</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><span class="p">]).</span><font class="badlink"><span class="nx">src</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">O_image</span></font><span class="p">;</span>
<span class="mi">167</span>                        <span class="p">}</span>
<span class="mi">168</span>                <span class="p">}</span>
<span class="mi">169</span>                <span class="p">});</span>
<span class="mi">170</span>                <font class="badlink"><span class="kd">var</span></font> <font class="badlink"><span class="nx">blinger</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nb">document</span></font><span class="p">.</span><font class="badlink"><span class="nx">getElementById</span></font><span class="p">(</span><span class="s2">"bling"</span><span class="p">);</span>
<span class="mi">171</span>                <font class="badlink"><span class="nx">blinger</span></font><span class="p">.</span><font class="badlink"><span class="nx">play</span></font><span class="p">();</span>
<span class="mi">172</span>    
<span class="mi">173</span>                <font class="badlink"><span class="nx">valid</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">(</span>
<span class="mi">174</span>                    <font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">os</span></font><span class="p">[</span><font class="badlink"><span class="nx">handToInt</span></font><span class="p">[</span><font class="badlink"><span class="nx">hand</span></font><span class="p">]])</span>
<span class="mi">175</span>                    <font class="badlink"><span class="o">+</span></font> <font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">xs</span></font><span class="p">[</span><font class="badlink"><span class="nx">handToInt</span></font><span class="p">[</span><font class="badlink"><span class="nx">hand</span></font><span class="p">]])</span>
<span class="mi">176</span>                <span class="p">);</span> <span class="c1">// should return 1=occupied / 0=vacant</span>
<span class="mi">177</span>                <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nx">dev</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">178</span>                    <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`</span><span class="si">${</span><font class="badlink"><span class="nx">valid</span></font><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="mi">179</span>                <span class="p">}</span>
<span class="mi">180</span>    
<span class="mi">181</span>            <span class="p">};</span>
<span class="mi">182</span>            
<span class="mi">183</span>            <font class="badlink"><span class="nx">sleep</span></font><span class="p">(</span><span class="mi">4000</span><span class="p">);</span>
<span class="mi">184</span>    
<span class="mi">185</span>            <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nx">dev</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">186</span>                <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`</span><span class="si">${</span><font class="badlink"><span class="nx">os</span></font><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="mi">187</span>                <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`</span><span class="si">${</span><font class="badlink"><span class="nx">xs</span></font><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="mi">188</span>            <span class="p">}</span>
<span class="mi">189</span>            
<span class="mi">190</span>            <span class="c1">// Display that a move as been accepted</span>
<span class="mi">191</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">192</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"GetHandb"</span><span class="p">,</span>
<span class="mi">193</span>                <font class="badlink"><span class="nx">playable</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="kc">true</span></font>
<span class="mi">194</span>            <span class="p">});</span>
<span class="mi">195</span>    
<span class="mi">196</span>            <font class="badlink"><span class="nb">document</span></font><span class="p">.</span><font class="badlink"><span class="nx">getElementById</span></font><span class="p">(</span><font class="badlink"><span class="nx">hand</span></font><span class="p">).</span><font class="badlink"><span class="nx">src</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">197</span>                <font class="badlink"><span class="nx">x</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">X_image</span></font><span class="p">,</span> 
<span class="mi">198</span>                <font class="badlink"><span class="nx">o</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">O_image</span></font><span class="p">,</span>
<span class="mi">199</span>            <span class="p">}[</span><font class="badlink"><span class="nx">x</span></font> <font class="badlink"><span class="o">?</span></font> <span class="s2">"x"</span> <font class="badlink"><span class="o">:</span></font> <span class="s2">"o"</span><span class="p">];</span>
<span class="mi">200</span>    
<span class="mi">201</span>            <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nx">dev</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">202</span>                <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`</span><span class="si">${</span><font class="badlink"><span class="nx">hand</span></font><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="mi">203</span>            <span class="p">}</span>
<span class="mi">204</span>            <font class="badlink"><span class="k">for</span></font> <span class="p">(</span><font class="badlink"><span class="kd">let</span></font> <font class="badlink"><span class="nx">i</span></font> <font class="badlink"><span class="o">=</span></font> <span class="mi">1</span><span class="p">;</span> <font class="badlink"><span class="nx">i</span></font> <font class="badlink"><span class="o">&lt;</span></font> <span class="mi">10</span><span class="p">;</span> <font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">++</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">205</span>                <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nx">dev</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">206</span>                    <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`</span><span class="si">${</span><font class="badlink"><span class="nx">i</span></font><span class="si">}</span><span class="sb"> </span><span class="si">${</span><font class="badlink"><span class="nx">intToHand</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><span class="p">]</span><span class="si">}</span><span class="sb"> xs[i-1]=</span><span class="si">${</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">xs</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="sb"> os[i-1]=</span><span class="si">${</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">os</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="mi">207</span>                <span class="p">}</span>
<span class="mi">208</span>                <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">xs</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span> <font class="badlink"><span class="o">===</span></font> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">209</span>                    <font class="badlink"><span class="nb">document</span></font><span class="p">.</span><font class="badlink"><span class="nx">getElementById</span></font><span class="p">(</span><font class="badlink"><span class="nx">intToHand</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><span class="p">]).</span><font class="badlink"><span class="nx">src</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">X_image</span></font><span class="p">;</span> 
<span class="mi">210</span>                <span class="p">}</span>
<span class="mi">211</span>                <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nb">parseInt</span></font><span class="p">(</span><font class="badlink"><span class="nx">os</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><font class="badlink"><span class="o">-</span></font><span class="mi">1</span><span class="p">])</span> <font class="badlink"><span class="o">===</span></font> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">212</span>                    <font class="badlink"><span class="nb">document</span></font><span class="p">.</span><font class="badlink"><span class="nx">getElementById</span></font><span class="p">(</span><font class="badlink"><span class="nx">intToHand</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><span class="p">]).</span><font class="badlink"><span class="nx">src</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">O_image</span></font><span class="p">;</span>
<span class="mi">213</span>                <span class="p">}</span>
<span class="mi">214</span>            <span class="p">}</span>
<span class="mi">215</span>    
<span class="mi">216</span>            <span class="c1">// return the move</span>
<span class="mi">217</span>            <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">handToInt</span></font><span class="p">[</span><font class="badlink"><span class="nx">hand</span></font><span class="p">];</span>
<span class="mi">218</span>        <span class="p">}</span>
<span class="mi">219</span>    
<span class="mi">220</span>        <span class="c1">// function to display who won</span>
<span class="mi">221</span>        <font class="badlink"><span class="nx">endsWith</span></font><span class="p">(</span><font class="badlink"><span class="nx">won</span></font><span class="p">,</span> <font class="badlink"><span class="kr">double</span></font><span class="p">,</span> <font class="badlink"><span class="nx">oppo</span></font><span class="p">,</span> <font class="badlink"><span class="nx">tie</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">222</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">223</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Finale"</span><span class="p">,</span>
<span class="mi">224</span>                <font class="badlink"><span class="nx">won</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">won</span></font><span class="p">,</span>
<span class="mi">225</span>                <font class="badlink"><span class="kr">double</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="kr">double</span></font><span class="p">,</span>
<span class="mi">226</span>                <font class="badlink"><span class="nx">tie</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">tie</span></font>
<span class="mi">227</span>            <span class="p">});</span>
<span class="mi">228</span>        <span class="p">}</span>
<span class="mi">229</span>    
<span class="mi">230</span>        <span class="c1">// Inform the players that a timeout has occurred</span>
<span class="mi">231</span>        <font class="badlink"><span class="nx">informTimeout</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">232</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">233</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Timeout"</span>
<span class="mi">234</span>            <span class="p">});</span>
<span class="mi">235</span>        <span class="p">}</span>
<span class="mi">236</span>    
<span class="mi">237</span>        <span class="c1">// returns hand to Reach</span>
<span class="mi">238</span>        <font class="badlink"><span class="nx">setImg</span></font><span class="p">(</span><font class="badlink"><span class="nx">box_id</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">239</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">resolveHandP</span></font><span class="p">(</span><font class="badlink"><span class="nx">box_id</span></font><span class="p">);</span>
<span class="mi">240</span>        <span class="p">}</span>
<span class="mi">241</span>    <span class="p">}</span>
<span class="p">...</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 138, we provide the <code class="highlight"><font class="badlink"><span class="nx">random</span></font></code> callback</p></li><li><p>On lines 142 thru 218, we provide the <code class="highlight"><font class="badlink"><span class="nx">getHand</span></font></code> callback.</p></li><li><p>On lines 221 thru 235, we provide the <code class="highlight"><font class="badlink"><span class="nx">seeOutcome</span></font></code> and <code class="highlight"><font class="badlink"><span class="nx">informTimeout</span></font></code> callbacks,
which set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Done</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Done%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">2</span></a>), as well as a timeout page.</p></li><li><p>On line 238, we define what happens when the user clicks a button:
The <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> from line 150 is resolved.</p></li></ul><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Done.png" alt="" width="757" height="266"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Done))" x-target-lift="Figure"></a>Figure&nbsp;2: </span>The <code class="highlight"><font class="badlink"><span class="nx">Done</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/PlayerViews.js#L44-L54">PlayerViews.Done</a></span></p></blockquote><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">Next, we will define <code class="highlight"><font class="badlink"><span class="nx">Deployer</span></font></code> as a React component for Alice,
which extends <code class="highlight"><font class="badlink"><span class="nx">Player</span></font></code>.</div></p><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="SetWager.png" alt="" width="433" height="271"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Set.Wager))" x-target-lift="Figure"></a>Figure&nbsp;3: </span>The <code class="highlight"><font class="badlink"><span class="nx">SetWager</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/DeployerViews.js#L20-L38">DeployerViews.SetWager</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Deploy.png" alt="" width="442" height="258"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Deploy))" x-target-lift="Figure"></a>Figure&nbsp;4: </span>The <code class="highlight"><font class="badlink"><span class="nx">Deploy</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/DeployerViews.js#L40-L53">DeployerViews.Deploy</a></span></p></blockquote></div></p><p>Our Web frontend needs to implement the <font class="badlink"><span class="techoutside"><span class="techinside">participant interact interface</span></span></font> for Alice, which we defined as:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.rsh#L78-L80"><span class="stt">tic-tac-7/index.rsh</span></a><button class="btn" data-clipboard-text="const Alice =
      { ...Player,
        wager: UInt };"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mi">78</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">Alice</span></font> <font class="badlink"><span class="o">=</span></font>
<span class="mi">79</span>          <span class="p">{</span> <span class="p">...</span><font class="badlink"><span class="nx">Player</span></font><span class="p">,</span>
<span class="mi">80</span>            <font class="badlink"><span class="nx">wager</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nb">UInt</span></font> <span class="p">};</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>We will provide the <code class="highlight"><font class="badlink"><span class="nx">wager</span></font></code> value,
and define some button handlers in order to trigger the deployment of the contract.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js#L244-L283"><span class="stt">tic-tac-7/index.js</span></a><button class="btn" data-clipboard-text="class Deployer extends Player {
    // Set the wager
    constructor(props) {
        super(props);
        this.state = {
            view: &quot;SetWager&quot;
        };
    }
    setWager(wager) {
        this.setState({
            view: &quot;Deploy&quot;,
            wager
        });
    }

    // Deploy the contract
    async deploy() {
        const ctc = this.props.acc.deploy(backend);
        this.setState({
            view: &quot;Deploying&quot;,
            ctc
        });
        this.wager = reach.parseCurrency(this.state.wager); // UInt
        backend.A(ctc, this);
        if (dev) {
            console.log(await reach.getDefaultAccount());
        }
        const ctcInfo = await ctc.getInfo();
        const ctcInfoStr = JSON.stringify(ctcInfo, null, 2);
        this.setState({
            view: &quot;WaitingForAttacher&quot;,
            ctcInfoStr
        });
    }

    // render the data returned by the class
    render() {
        return renderView(this, DeployerViews);
    }
}"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">...</span>    <span class="c1">// ...</span>
<span class="mi">244</span>    <font class="badlink"><span class="kr">class</span></font> <font class="badlink"><span class="nx">Deployer</span></font> <font class="badlink"><span class="kr">extends</span></font> <font class="badlink"><span class="nx">Player</span></font> <span class="p">{</span>
<span class="mi">245</span>        <span class="c1">// Set the wager</span>
<span class="mi">246</span>        <font class="badlink"><span class="nx">constructor</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">247</span>            <font class="badlink"><span class="kr">super</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">);</span>
<span class="mi">248</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">249</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"SetWager"</span>
<span class="mi">250</span>            <span class="p">};</span>
<span class="mi">251</span>        <span class="p">}</span>
<span class="mi">252</span>        <font class="badlink"><span class="nx">setWager</span></font><span class="p">(</span><font class="badlink"><span class="nx">wager</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">253</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">254</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Deploy"</span><span class="p">,</span>
<span class="mi">255</span>                <font class="badlink"><span class="nx">wager</span></font>
<span class="mi">256</span>            <span class="p">});</span>
<span class="mi">257</span>        <span class="p">}</span>
<span class="mi">258</span>    
<span class="mi">259</span>        <span class="c1">// Deploy the contract</span>
<span class="mi">260</span>        <font class="badlink"><span class="nx">async</span></font> <font class="badlink"><span class="nx">deploy</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">261</span>            <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">ctc</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">props</span></font><span class="p">.</span><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><font class="badlink"><span class="nx">deploy</span></font><span class="p">(</span><font class="badlink"><span class="nx">backend</span></font><span class="p">);</span>
<span class="mi">262</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">263</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Deploying"</span><span class="p">,</span>
<span class="mi">264</span>                <font class="badlink"><span class="nx">ctc</span></font>
<span class="mi">265</span>            <span class="p">});</span>
<span class="mi">266</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">wager</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">parseCurrency</span></font><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">wager</span></font><span class="p">);</span> <span class="c1">// UInt</span>
<span class="mi">267</span>            <font class="badlink"><span class="nx">backend</span></font><span class="p">.</span><font class="badlink"><span class="nx">A</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctc</span></font><span class="p">,</span> <font class="badlink"><span class="k">this</span></font><span class="p">);</span>
<span class="mi">268</span>            <font class="badlink"><span class="k">if</span></font> <span class="p">(</span><font class="badlink"><span class="nx">dev</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">269</span>                <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">getDefaultAccount</span></font><span class="p">());</span>
<span class="mi">270</span>            <span class="p">}</span>
<span class="mi">271</span>            <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">ctcInfo</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">ctc</span></font><span class="p">.</span><font class="badlink"><span class="nx">getInfo</span></font><span class="p">();</span>
<span class="mi">272</span>            <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">ctcInfoStr</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">JSON</span></font><span class="p">.</span><font class="badlink"><span class="nx">stringify</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctcInfo</span></font><span class="p">,</span> <font class="badlink"><span class="kc">null</span></font><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="mi">273</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">274</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"WaitingForAttacher"</span><span class="p">,</span>
<span class="mi">275</span>                <font class="badlink"><span class="nx">ctcInfoStr</span></font>
<span class="mi">276</span>            <span class="p">});</span>
<span class="mi">277</span>        <span class="p">}</span>
<span class="mi">278</span>    
<span class="mi">279</span>        <span class="c1">// render the data returned by the class</span>
<span class="mi">280</span>        <font class="badlink"><span class="nx">render</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">281</span>            <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">renderView</span></font><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">,</span> <font class="badlink"><span class="nx">DeployerViews</span></font><span class="p">);</span>
<span class="mi">282</span>        <span class="p">}</span>
<span class="mi">283</span>    <span class="p">}</span>
<span class="p">...</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 249, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">SetWager</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Set.Wager%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">3</span></a>).</p></li><li><p>On line 250, we define what to do when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Set Wager</span><span class="hspace"></span></span> button,
which is to set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Deploy</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Deploy%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">4</span></a>).</p></li><li><p><div class="SIntrapara">On lines 260 thru 277, we define what to do when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Deploy</span><span class="hspace"></span></span> button. </div><div class="SIntrapara"><ul><li><p>On line 261, we call <code class="highlight"><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><font class="badlink"><span class="nx">deploy</span></font></code>, which triggers a deploy of the contract.</p></li><li><p>On line 263, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Deploying</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Deploying%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">5</span></a>).</p></li><li><p>On line 266, we set the <code class="highlight"><font class="badlink"><span class="nx">wager</span></font></code> property.</p></li><li><p>On line 271, we start running the Reach program as Alice, using the <code class="highlight"><font class="badlink"><span class="k">this</span></font></code> React component
as the <font class="badlink"><span class="techoutside"><span class="techinside">participant interact interface</span></span></font> object.</p></li><li><p>On lines 274 and 275, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">WaitingForAttacher</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Waiting.For.Attacher%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">6</span></a>),
which displays the deployed contract info as JSON.</p></li></ul></div></p></li><li><p>On line 281, we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/DeployerViews.js"><span class="stt">tic-tac-7/views/DeployerViews.js</span></a>.</p></li></ul><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Deploying.png" alt="" width="432" height="204"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Deploying))" x-target-lift="Figure"></a>Figure&nbsp;5: </span>The <code class="highlight"><font class="badlink"><span class="nx">Deploying</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/DeployerViews.js#L55-L61">DeployerViews.Deploying</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="WaitingForAttacher.png" alt="" width="687" height="332"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Waiting.For.Attacher))" x-target-lift="Figure"></a>Figure&nbsp;6: </span>The <code class="highlight"><font class="badlink"><span class="nx">WaitingForAttacher</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/DeployerViews.js#L63-L90">DeployerViews.WaitingForAttacher</a></span></p></blockquote></div></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Attach.png" alt="" width="720" height="406"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Attach))" x-target-lift="Figure"></a>Figure&nbsp;7: </span>The <code class="highlight"><font class="badlink"><span class="nx">Attach</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/AttacherViews.js#L18-L39">AttacherViews.Attach</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Attaching.png" alt="" width="436" height="204"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Attaching))" x-target-lift="Figure"></a>Figure&nbsp;8: </span>The <code class="highlight"><font class="badlink"><span class="nx">Attaching</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/AttacherViews.js#L41-L49">AttacherViews.Attaching</a></span></p></blockquote></div></p><p>Our web frontend needs to implement the <font class="badlink"><span class="techoutside"><span class="techinside">participant interact interface</span></span></font> for Bob, which we defined as:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.rsh#L81-L83"><span class="stt">tic-tac-7/index.rsh</span></a><button class="btn" data-clipboard-text="const Bob =
      { ...Player,
        acceptWager: Fun([UInt], Null) };"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mi">81</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">Bob</span></font> <font class="badlink"><span class="o">=</span></font>
<span class="mi">82</span>          <span class="p">{</span> <span class="p">...</span><font class="badlink"><span class="nx">Player</span></font><span class="p">,</span>
<span class="mi">83</span>            <font class="badlink"><span class="nx">acceptWager</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nb">Fun</span></font><span class="p">([</span><font class="badlink"><span class="nb">UInt</span></font><span class="p">],</span> <font class="badlink"><span class="nb">Null</span></font><span class="p">)</span> <span class="p">};</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>We will provide the <code class="highlight"><font class="badlink"><span class="nx">acceptWager</span></font></code> callback,
and define some button handlers in order to attach to the deployed contract.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js#L286-L327"><span class="stt">tic-tac-7/index.js</span></a><button class="btn" data-clipboard-text="class Attacher extends Player {
    // Display the view for attaching to the deployer
    constructor(props) {
        super(props);
        this.state = {
            view: &quot;Attach&quot;
        };
    }
    // Actually attach
    attach(ctcInfoStr) {
        const ctc = this.props.acc.attach(backend, JSON.parse(ctcInfoStr));
        this.setState({
            view: &quot;Attaching&quot;
        });
        backend.B(ctc, this);
    }

    // accept the wager proposed by the deployer
    async acceptWager(wagerAtomic) {
        // Fun([UInt], Null)
        const wager = reach.formatCurrency(wagerAtomic, 4);
        return await new Promise((resolveAcceptedP) =&gt; {
            this.setState({
                view: &quot;AcceptTerms&quot;,
                wager,
                resolveAcceptedP
            });
        });
    }
    // if the terms have been accepted, display that the player is waiting for his/her turn.
    termsAccepted() {
        this.state.resolveAcceptedP();
        this.setState({
            view: &quot;WaitingForTurn&quot;
        });
    }

    // render that data returned by this class
    render() {
        return renderView(this, AttacherViews);
    }
}"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">...</span>    <span class="c1">// ...</span>
<span class="mi">286</span>    <font class="badlink"><span class="kr">class</span></font> <font class="badlink"><span class="nx">Attacher</span></font> <font class="badlink"><span class="kr">extends</span></font> <font class="badlink"><span class="nx">Player</span></font> <span class="p">{</span>
<span class="mi">287</span>        <span class="c1">// Display the view for attaching to the deployer</span>
<span class="mi">288</span>        <font class="badlink"><span class="nx">constructor</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">289</span>            <font class="badlink"><span class="kr">super</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">);</span>
<span class="mi">290</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">291</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Attach"</span>
<span class="mi">292</span>            <span class="p">};</span>
<span class="mi">293</span>        <span class="p">}</span>
<span class="mi">294</span>        <span class="c1">// Actually attach</span>
<span class="mi">295</span>        <font class="badlink"><span class="nx">attach</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctcInfoStr</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">296</span>            <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">ctc</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">props</span></font><span class="p">.</span><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><font class="badlink"><span class="nx">attach</span></font><span class="p">(</span><font class="badlink"><span class="nx">backend</span></font><span class="p">,</span> <font class="badlink"><span class="nx">JSON</span></font><span class="p">.</span><font class="badlink"><span class="nx">parse</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctcInfoStr</span></font><span class="p">));</span>
<span class="mi">297</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">298</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"Attaching"</span>
<span class="mi">299</span>            <span class="p">});</span>
<span class="mi">300</span>            <font class="badlink"><span class="nx">backend</span></font><span class="p">.</span><font class="badlink"><span class="nx">B</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctc</span></font><span class="p">,</span> <font class="badlink"><span class="k">this</span></font><span class="p">);</span>
<span class="mi">301</span>        <span class="p">}</span>
<span class="mi">302</span>    
<span class="mi">303</span>        <span class="c1">// accept the wager proposed by the deployer</span>
<span class="mi">304</span>        <font class="badlink"><span class="nx">async</span></font> <font class="badlink"><span class="nx">acceptWager</span></font><span class="p">(</span><font class="badlink"><span class="nx">wagerAtomic</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mi">305</span>            <span class="c1">// Fun([UInt], Null)</span>
<span class="mi">306</span>            <font class="badlink"><span class="kr">const</span></font> <font class="badlink"><span class="nx">wager</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">formatCurrency</span></font><span class="p">(</span><font class="badlink"><span class="nx">wagerAtomic</span></font><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="mi">307</span>            <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="k">new</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">((</span><font class="badlink"><span class="nx">resolveAcceptedP</span></font><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="mi">308</span>                <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">309</span>                    <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"AcceptTerms"</span><span class="p">,</span>
<span class="mi">310</span>                    <font class="badlink"><span class="nx">wager</span></font><span class="p">,</span>
<span class="mi">311</span>                    <font class="badlink"><span class="nx">resolveAcceptedP</span></font>
<span class="mi">312</span>                <span class="p">});</span>
<span class="mi">313</span>            <span class="p">});</span>
<span class="mi">314</span>        <span class="p">}</span>
<span class="mi">315</span>        <span class="c1">// if the terms have been accepted, display that the player is waiting for his/her turn.</span>
<span class="mi">316</span>        <font class="badlink"><span class="nx">termsAccepted</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">317</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">resolveAcceptedP</span></font><span class="p">();</span>
<span class="mi">318</span>            <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span>
<span class="mi">319</span>                <font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s2">"WaitingForTurn"</span>
<span class="mi">320</span>            <span class="p">});</span>
<span class="mi">321</span>        <span class="p">}</span>
<span class="mi">322</span>    
<span class="mi">323</span>        <span class="c1">// render that data returned by this class</span>
<span class="mi">324</span>        <font class="badlink"><span class="nx">render</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mi">325</span>            <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">renderView</span></font><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">,</span> <font class="badlink"><span class="nx">AttacherViews</span></font><span class="p">);</span>
<span class="mi">326</span>        <span class="p">}</span>
<span class="mi">327</span>    <span class="p">}</span>
<span class="p">...</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 291, we initialize the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Attach</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Attach%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">7</span></a>).</p></li><li><p><div class="SIntrapara">On lines 295 thru 321, we define what happens when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Attach</span><span class="hspace"></span></span> button. </div><div class="SIntrapara"><ul><li><p>On line 296, we call <code class="highlight"><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><font class="badlink"><span class="nx">attach</span></font></code></p></li><li><p>On line 298, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Attaching</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Attaching%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">8</span></a>).</p></li><li><p>On line 300, we start running the Reach program as Bob, using the <code class="highlight"><font class="badlink"><span class="k">this</span></font></code> React component
as the <font class="badlink"><span class="techoutside"><span class="techinside">participant interact interface</span></span></font> object.</p></li></ul></div></p></li><li><p><div class="SIntrapara">On lines 304 thru 314, we define the <code class="highlight"><font class="badlink"><span class="nx">acceptWager</span></font></code> callback. </div><div class="SIntrapara"><ul><li><p>On lines 308 thru 312, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">AcceptTerms</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Accept.Terms%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">9</span></a>),
and wait for a <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> which can be resolved via user interaction.</p></li></ul></div></p></li><li><p>On lines 316 thru 321, we define what happens when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Accept Terms and Pay Wager</span><span class="hspace"></span></span> button:
the <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> from line 307 is resolved, and we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">WaitingForTurn</span></font></code> view (<a href="#%28counter._%28figure._fig~3atic-tac-7%2Fviews%2F.Waiting.For.Turn%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">10</span></a>).</p></li><li><p>On line 325 we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/AttacherViews.js"><span class="stt">tic-tac-7/views/AttacherViews.js</span></a></p></li></ul><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="AcceptTerms.png" alt="" width="432" height="280"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Accept.Terms))" x-target-lift="Figure"></a>Figure&nbsp;9: </span>The <code class="highlight"><font class="badlink"><span class="nx">AcceptTerms</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/AttacherViews.js#L51-L70">AttacherViews.AcceptTerms</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="WaitingForTurn.png" alt="" width="441" height="221"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atic-tac-7/views/.Waiting.For.Turn))" x-target-lift="Figure"></a>Figure&nbsp;10: </span>The <code class="highlight"><font class="badlink"><span class="nx">WaitingForTurn</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/AttacherViews.js#L72-L81">AttacherViews.WaitingForTurn</a></span></p></blockquote></div></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/index.js#L330-L330"><span class="stt">tic-tac-7/index.js</span></a><button class="btn" data-clipboard-text="renderDOM( &lt; App / &gt; );"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">...</span>    <span class="c1">// ...</span>
<span class="mi">330</span>    <font class="badlink"><span class="nx">renderDOM</span></font><span class="p">(</span> <font class="badlink"><span class="o">&lt;</span></font> <font class="badlink"><span class="nx">App</span></font> <font class="badlink"><span class="o">/</span></font> <font class="badlink"><span class="o">&gt;</span></font> <span class="p">);</span>
</pre></div></div></p><p>Finally, we call a small helper function from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tic-tac-7/views/render.js"><span class="stt">tic-tac-7/views/render.js</span></a>
to render our App component.</p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">As a convenience for running the React development server,
you can call:</div></p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">./reach react</span></p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>To run the React development server with Algorand, take a look at the <a href="algo.html" data-pltdoc="x">running on Algorand</a> section.</p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">If you&rsquo;d like to instead use Reach in your own JavaScript project,
you can call:</div></p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">npm install @reach-sh/stdlib</span></p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The Reach standard library is undergoing continual improvement and is updated often.
If you are experiencing issues with the Node.js package, try updating!</p></blockquote></blockquote></blockquote><p>As usual, you can compile your Reach program <span class="RktInBG"><span class="hspace"></span><span class="RktIn">index.rsh</span><span class="hspace"></span></span> to the <code class="highlight"><font class="badlink"><span class="nx">backend</span></font></code> build artifact <span class="RktInBG"><span class="hspace"></span><span class="RktIn">build/index.main.mjs</span><span class="hspace"></span></span> with:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">./reach compile</span></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">Now our implementation of Tic-Tac-Toe is live in the browser!
We can leverage callbacks in the <font class="badlink"><span class="techoutside"><span class="techinside">participant interact interface</span></span></font> to display to and gather information from the user,
through any Web UI framework of our choice.</div></p><p>If we wanted to deploy this application to the world, then we would take the static files that React produces and host them on a Web server.
These files embed your compiled Reach program, so there&rsquo;s nothing more to do than provide them to the world.</p><p><a href="index.html" data-pltdoc="x">Main menu</a></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tic-tac-6.html" title="backward to &quot;6 Interaction and Independence&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pay-To-Play Tic-Tac-Toe Tutorial&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="algo.html" title="forward to &quot;8 Running on Algorand&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>