<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-149147406-2"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-149147406-2');</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><script src="tooltips.js"></script><script src="reach-pre.js"></script><link rel="stylesheet" href="tooltips.css"><link rel="stylesheet" href="reach.css"><link rel="stylesheet" href="minted.css"><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"><link rel="manifest" href="/favicon/site.webmanifest"><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2.9&nbsp;Web Interaction</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="figure.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="figure.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Reach:<span class="mywbr"> &nbsp;</span> The Safest and Easiest DApp Programming Language</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="overview.html" class="tocviewlink" data-pltdoc="x">Overview</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="tut.html" class="tocviewselflink" data-pltdoc="x">Tutorial</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="guide.html" class="tocviewlink" data-pltdoc="x">Guide</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="workshop.html" class="tocviewlink" data-pltdoc="x">Workshop</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="ref.html" class="tocviewlink" data-pltdoc="x">Reference</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>2&nbsp;</td><td><a href="tut.html" class="tocviewlink" data-pltdoc="x">Tutorial</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="tut-1.html" class="tocviewlink" data-pltdoc="x">Install and Initialize</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="tut-2.html" class="tocviewlink" data-pltdoc="x">Scaffolding and Setup</a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="tut-3.html" class="tocviewlink" data-pltdoc="x">Rock, Paper, and Scissors</a></td></tr><tr><td align="right">2.4&nbsp;</td><td><a href="tut-4.html" class="tocviewlink" data-pltdoc="x">Bets and Wagers</a></td></tr><tr><td align="right">2.5&nbsp;</td><td><a href="tut-5.html" class="tocviewlink" data-pltdoc="x">Trust and Commitments</a></td></tr><tr><td align="right">2.6&nbsp;</td><td><a href="tut-6.html" class="tocviewlink" data-pltdoc="x">Timeouts and Participation</a></td></tr><tr><td align="right">2.7&nbsp;</td><td><a href="tut-7.html" class="tocviewlink" data-pltdoc="x">Play and Play Again</a></td></tr><tr><td align="right">2.8&nbsp;</td><td><a href="tut-8.html" class="tocviewlink" data-pltdoc="x">Interaction and Independence</a></td></tr><tr><td align="right">2.9&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Web Interaction</a></td></tr><tr><td align="right">2.10&nbsp;</td><td><a href="tut-10.html" class="tocviewlink" data-pltdoc="x">Onward and Further</a></td></tr><tr><td align="right">2.11&nbsp;</td><td><a href="tut-7-rpc.html" class="tocviewlink" data-pltdoc="x">Rock, Paper, Scissors in Python</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search docs..." title="Enter a search string to search the Reach documentation" onkeypress="return reach_DoSearch(event, this);"></form>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tut-8.html" title="backward to &quot;2.8 Interaction and Independence&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="tut.html" title="up to &quot;2 Tutorial&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="tut-10.html" title="forward to &quot;2.10 Onward and Further&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>2.9<tt>&nbsp;</tt><a name="(part._tut-9)"></a>Web Interaction</h4><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Dan Burton &lt;<a href="mailto:dan@reach.sh">dan@reach.sh</a>&gt;</p></span></div><p>In the last section, we made <span class="emph">Rock, Paper, Scissors!</span> run as a command-line application, without any changes to the Reach program.
In this section, we again won&rsquo;t be making any changes to the Reach program.
Instead, we&rsquo;ll replace the command-line interface with a Web interface.</p><p>We will use <a href="https://reactjs.org/">React.js</a> for this tutorial, but the same principles apply to any Web framework.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><div class="SIntrapara">If you&rsquo;ve never used React before, here are some basics about how it works:
</div><div class="SIntrapara"><ul><li><p>React programs are JavaScript programs that use a special library that allows you to mix HTML inside of the body of your JavaScript.</p></li><li><p>React has a special compiler that combines a bundle of JavaScript programs, and all their dependencies, into one large file that can be deployed on a static Web server.
This is called "packing".</p></li><li><p>When you&rsquo;re developing and testing with React, you run a special development Web server that watches and updates this packed file every time you modify a source file, so you don&rsquo;t have to constantly run the compiler.</p></li><li><p>Reach automates the process of starting this development server for you when you run <span class="stt">./reach react</span> and gives you access to it at <span class="stt">http://localhost:3000/</span>.</p></li></ul></div></p></blockquote></blockquote></blockquote><p>Similarly, in this tutorial, we assume that we will be deploying (and testing) with Ethereum.
Reach Web applications rely on the Web browser to provide access to a consensus network account and its associated wallet.
On Ethereum, the standard wallet is <a href="https://metamask.io">MetaMask</a>.
If you want to test this code, you&rsquo;ll need to install it and set it up.
Furthermore, MetaMask does not support multiple active accounts, so if you want to test <span class="emph">Rock, Paper, Scissors!</span> locally, you&rsquo;ll need to have two separate browser instances: one to act as Alice and another to act as Bob.</p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>The code in this section does not use the scaffolding from the previous section.
Reach comes with a convenience command for deleting scaffolded files:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">./reach unscaffold</span></p><p>Similarly, you do not need the previous <span class="stt">index.mjs</span> file, because we&rsquo;ll be writing it completely from scratch to use React.
You can run the following command to delete it:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">rm index.mjs</span></p><p>Or, you can copy the <span class="stt">index.rsh</span> file into a new directory and work from there.</p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>This code is supplemented with <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.css">index.css</a>
and some <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views">views</a>.
These details are not specific to Reach, and are fairly trivial,
so we will not explain the specifics of those files.
If you run this locally, you&rsquo;ll want to download those files.
Your directory should look like:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">.</span></p></td></tr><tr><td><p><span class="stt">&#9500;&#9472;&#9472; index.css</span></p></td></tr><tr><td><p><span class="stt">&#9500;&#9472;&#9472; index.js</span></p></td></tr><tr><td><p><span class="stt">&#9500;&#9472;&#9472; index.rsh</span></p></td></tr><tr><td><p><span class="stt">&#9492;&#9472;&#9472; views</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; AppViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; AttacherViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; DeployerViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9500;&#9472;&#9472; PlayerViews.js</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&#9492;&#9472;&#9472; render.js</span></p></td></tr></table></p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>We will focus on <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js"><span class="stt">tut-9/index.js</span></a>,
because <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.rsh"><span class="stt">tut-9/index.rsh</span></a> is the same as previous sections.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L1-L9"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="import React from 'react';
import AppViews from './views/AppViews';
import DeployerViews from './views/DeployerViews';
import AttacherViews from './views/AttacherViews';
import {renderDOM, renderView} from './views/render';
import './index.css';
import * as backend from './build/index.main.mjs';
import {loadStdlib} from '@reach-sh/stdlib';
const reach = loadStdlib(process.env);"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span> <span class="mf">1</span>    <font class="badlink"><span class="k">import</span></font> <font class="badlink"><span class="nx">React</span></font> <font class="badlink"><span class="k">from</span></font> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
 <span class="mf">2</span>    <font class="badlink"><span class="k">import</span></font> <font class="badlink"><span class="nx">AppViews</span></font> <font class="badlink"><span class="k">from</span></font> <span class="s1">&#39;./views/AppViews&#39;</span><span class="p">;</span>
 <span class="mf">3</span>    <font class="badlink"><span class="k">import</span></font> <font class="badlink"><span class="nx">DeployerViews</span></font> <font class="badlink"><span class="k">from</span></font> <span class="s1">&#39;./views/DeployerViews&#39;</span><span class="p">;</span>
 <span class="mf">4</span>    <font class="badlink"><span class="k">import</span></font> <font class="badlink"><span class="nx">AttacherViews</span></font> <font class="badlink"><span class="k">from</span></font> <span class="s1">&#39;./views/AttacherViews&#39;</span><span class="p">;</span>
 <span class="mf">5</span>    <font class="badlink"><span class="k">import</span></font> <span class="p">{</span><font class="badlink"><span class="nx">renderDOM</span></font><span class="p">,</span> <font class="badlink"><span class="nx">renderView</span></font><span class="p">}</span> <font class="badlink"><span class="k">from</span></font> <span class="s1">&#39;./views/render&#39;</span><span class="p">;</span>
 <span class="mf">6</span>    <font class="badlink"><span class="k">import</span></font> <span class="s1">&#39;./index.css&#39;</span><span class="p">;</span>
 <span class="mf">7</span>    <font class="badlink"><span class="k">import</span></font> <font class="badlink"><span class="o">*</span></font> <font class="badlink"><span class="k">as</span></font> <a href="ref-backends-js.html#%28javascript._%28%28backend%29%29%29" class="nx" data-pltdoc="x">backend</a> <font class="badlink"><span class="k">from</span></font> <span class="s1">&#39;./build/index.main.mjs&#39;</span><span class="p">;</span>
 <span class="mf">8</span>    <font class="badlink"><span class="k">import</span></font> <span class="p">{</span><a href="ref-frontends-js-loader_mjs.html#%28javascript._%28%28load.Stdlib%29%29%29" class="nx" data-pltdoc="x">loadStdlib</a><span class="p">}</span> <font class="badlink"><span class="k">from</span></font> <span class="s1">&#39;@reach-sh/stdlib&#39;</span><span class="p">;</span>
 <span class="mf">9</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">reach</span></font> <font class="badlink"><span class="o">=</span></font> <a href="ref-frontends-js-loader_mjs.html#%28javascript._%28%28load.Stdlib%29%29%29" class="nx" data-pltdoc="x">loadStdlib</a><span class="p">(</span><font class="badlink"><span class="nx">process</span></font><span class="p">.</span><font class="badlink"><span class="nx">env</span></font><span class="p">);</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>On lines 1 thru 6, we import our view code and CSS.
On line 7, we import the compiled <code class="highlight"><font class="badlink"><span class="nx">backend</span></font></code>.
On lines 8 and 9, we load the <code class="highlight"><font class="badlink"><span class="nx">stdlib</span></font></code> as <code class="highlight"><font class="badlink"><span class="nx">reach</span></font></code>.</p><p>React compiles the Reach standard libray in such a way that
it does not have direct access to the environment variables
which are used to select the desired standard library.
This is why you need to pass <code class="highlight"><font class="badlink"><span class="nx">process</span></font><span class="p">.</span><font class="badlink"><span class="nx">env</span></font></code> as an argument
to achieve the desired effect.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L10-L14"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="const handToInt = {'ROCK': 0, 'PAPER': 1, 'SCISSORS': 2};
const intToOutcome = ['Bob wins!', 'Draw!', 'Alice wins!'];
const {standardUnit} = reach;
const defaults = {defaultFundAmt: '10', defaultWager: '3', standardUnit};
"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">10</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">handToInt</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span><span class="s1">&#39;ROCK&#39;</span><font class="badlink"><span class="o">:</span></font> <span class="mf">0</span><span class="p">,</span> <span class="s1">&#39;PAPER&#39;</span><font class="badlink"><span class="o">:</span></font> <span class="mf">1</span><span class="p">,</span> <span class="s1">&#39;SCISSORS&#39;</span><font class="badlink"><span class="o">:</span></font> <span class="mf">2</span><span class="p">};</span>
<span class="mf">11</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">intToOutcome</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">[</span><span class="s1">&#39;Bob wins!&#39;</span><span class="p">,</span> <span class="s1">&#39;Draw!&#39;</span><span class="p">,</span> <span class="s1">&#39;Alice wins!&#39;</span><span class="p">];</span>
<span class="mf">12</span>    <font class="badlink"><span class="kd">const</span></font> <span class="p">{</span><a href="ref-frontends-js-utils.html#%28javascript._%28%28standard.Unit%29%29%29" class="nx" data-pltdoc="x">standardUnit</a><span class="p">}</span> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">;</span>
<span class="mf">13</span>    <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">defaults</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span><font class="badlink"><span class="nx">defaultFundAmt</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">defaultWager</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <a href="ref-frontends-js-utils.html#%28javascript._%28%28standard.Unit%29%29%29" class="nx" data-pltdoc="x">standardUnit</a><span class="p">};</span>
<span class="mf">14</span>    
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>On these lines we define a few helpful constants and defaults for later,
some corresponding to the enumerations we defined in Reach.</p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">We start defining <code class="highlight"><font class="badlink"><span class="nx">App</span></font></code> as a React component,
and tell it what to do once it mounts, which is the React term for starting.</div></p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="ConnectAccount.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Connect.Account))" x-target-lift="Figure"></a>Figure&nbsp;1: </span>The <code class="highlight"><font class="badlink"><span class="nx">ConnectAccount</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AppViews.js#L19-L28">AppViews.ConnectAccount</a></span></p></blockquote><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L15-L31"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {view: 'ConnectAccount', ...defaults};
  }
  async componentDidMount() {
    const acc = await reach.getDefaultAccount();
    const balAtomic = await reach.balanceOf(acc);
    const bal = reach.formatCurrency(balAtomic, 4);
    this.setState({acc, bal});
    try {
      const faucet = await reach.getFaucet();
      this.setState({view: 'FundAccount', faucet});
    } catch (e) {
      this.setState({view: 'DeployerOrAttacher'});
    }
  }"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">15</span>    <font class="badlink"><span class="kd">class</span></font> <font class="badlink"><span class="nx">App</span></font> <font class="badlink"><span class="k">extends</span></font> <font class="badlink"><span class="nx">React</span></font><span class="p">.</span><font class="badlink"><span class="nx">Component</span></font> <span class="p">{</span>
<span class="mf">16</span>      <font class="badlink"><span class="nx">constructor</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mf">17</span>        <font class="badlink"><span class="k">super</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">);</span>
<span class="mf">18</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;ConnectAccount&#39;</span><span class="p">,</span> <span class="p">...</span><font class="badlink"><span class="nx">defaults</span></font><span class="p">};</span>
<span class="mf">19</span>      <span class="p">}</span>
<span class="mf">20</span>      <font class="badlink"><span class="k">async</span></font> <font class="badlink"><span class="nx">componentDidMount</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mf">21</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">acc</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-acc.html#%28javascript._%28%28get.Default.Account%29%29%29" class="nx" data-pltdoc="x">getDefaultAccount</a><span class="p">();</span>
<span class="mf">22</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">balAtomic</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-acc.html#%28javascript._%28%28balance.Of%29%29%29" class="nx" data-pltdoc="x">balanceOf</a><span class="p">(</span><font class="badlink"><span class="nx">acc</span></font><span class="p">);</span>
<span class="mf">23</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">bal</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-utils.html#%28javascript._%28%28format.Currency%29%29%29" class="nx" data-pltdoc="x">formatCurrency</a><span class="p">(</span><font class="badlink"><span class="nx">balAtomic</span></font><span class="p">,</span> <span class="mf">4</span><span class="p">);</span>
<span class="mf">24</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">acc</span></font><span class="p">,</span> <font class="badlink"><span class="nx">bal</span></font><span class="p">});</span>
<span class="mf">25</span>        <font class="badlink"><span class="k">try</span></font> <span class="p">{</span>
<span class="mf">26</span>          <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">faucet</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">getFaucet</span></font><span class="p">();</span>
<span class="mf">27</span>          <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;FundAccount&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">faucet</span></font><span class="p">});</span>
<span class="mf">28</span>        <span class="p">}</span> <font class="badlink"><span class="k">catch</span></font> <span class="p">(</span><font class="badlink"><span class="nx">e</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mf">29</span>          <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;DeployerOrAttacher&#39;</span><span class="p">});</span>
<span class="mf">30</span>        <span class="p">}</span>
<span class="mf">31</span>      <span class="p">}</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L39-L41"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="  render() { return renderView(this, AppViews); }
}
"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">39</span>      <font class="badlink"><span class="nx">render</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">renderView</span></font><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">,</span> <font class="badlink"><span class="nx">AppViews</span></font><span class="p">);</span> <span class="p">}</span>
<span class="mf">40</span>    <span class="p">}</span>
<span class="mf">41</span>    
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 18, we initialize the component state to display the <code class="highlight"><font class="badlink"><span class="nx">ConnectAccount</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Connect.Account%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">1</span></a>).</p></li><li><p>On lines 20 thru 31, we hook into React&rsquo;s <code class="highlight"><font class="badlink"><span class="nx">componentDidMount</span></font></code> lifecycle event, which is called when the component starts.</p></li><li><p>On line 21, we use <code class="highlight"><a href="ref-frontends-js-acc.html#%28javascript._%28%28get.Default.Account%29%29%29" class="nx" data-pltdoc="x">getDefaultAccount</a></code>, which accesses the default browser account.
For example, when used with Ethereum, it can discover the currently-selected MetaMask account.</p></li><li><p>On line 26, we use <code class="highlight"><font class="badlink"><span class="nx">getFaucet</span></font></code> to try and access the Reach developer testing network faucet.</p></li><li><p>On line 27, if <code class="highlight"><font class="badlink"><span class="nx">getFaucet</span></font></code> was successful, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">FundAccount</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Fund.Account%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">2</span></a>).</p></li><li><p>On line 29, if <code class="highlight"><font class="badlink"><span class="nx">getFaucet</span></font></code> was unsuccessful, we set the component state to skip to the <code class="highlight"><font class="badlink"><span class="nx">DeployerOrAttacher</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Deployer.Or.Attacher%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">3</span></a>).</p></li><li><p>On line 39, we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AppViews.js"><span class="stt">tut-9/views/AppViews.js</span></a>.</p></li></ul><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="FundAccount.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Fund.Account))" x-target-lift="Figure"></a>Figure&nbsp;2: </span>The <code class="highlight"><font class="badlink"><span class="nx">FundAccount</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AppViews.js#L30-L54">AppViews.FundAccount</a></span></p></blockquote><p>Next, we define callbacks on <code class="highlight"><font class="badlink"><span class="nx">App</span></font></code> for what to do when the user clicks certain buttons.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L32-L36"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="  async fundAccount(fundAmount) {
    await reach.transfer(this.state.faucet, this.state.acc, reach.parseCurrency(fundAmount));
    this.setState({view: 'DeployerOrAttacher'});
  }
  async skipFundAccount() { this.setState({view: 'DeployerOrAttacher'}); }"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="p">.</span> <span class="c1">// ...</span>
<span class="mf">32</span>     <font class="badlink"><span class="k">async</span></font> <font class="badlink"><span class="nx">fundAccount</span></font><span class="p">(</span><font class="badlink"><span class="nx">fundAmount</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mf">33</span>       <font class="badlink"><span class="k">await</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-acc.html#%28javascript._%28%28transfer%29%29%29" class="nx" data-pltdoc="x">transfer</a><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">faucet</span></font><span class="p">,</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">acc</span></font><span class="p">,</span> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-utils.html#%28javascript._%28%28parse.Currency%29%29%29" class="nx" data-pltdoc="x">parseCurrency</a><span class="p">(</span><font class="badlink"><span class="nx">fundAmount</span></font><span class="p">));</span>
<span class="mf">34</span>       <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;DeployerOrAttacher&#39;</span><span class="p">});</span>
<span class="mf">35</span>     <span class="p">}</span>
<span class="mf">36</span>     <font class="badlink"><span class="k">async</span></font> <font class="badlink"><span class="nx">skipFundAccount</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;DeployerOrAttacher&#39;</span><span class="p">});</span> <span class="p">}</span>
<span class="p">..</span>    <span class="p">.</span> <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On lines 32 thru 35, we define what happens when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Fund Account</span><span class="hspace"></span></span> button.</p></li><li><p>On line 33, we transfer funds from the faucet to the user&rsquo;s account.</p></li><li><p>On line 34, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">DeployerOrAttacher</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Deployer.Or.Attacher%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">3</span></a>).</p></li><li><p>On line 36, we define what to do when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Skip</span><span class="hspace"></span></span> button,
which is to set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">DeployerOrAttacher</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Deployer.Or.Attacher%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">3</span></a>).</p></li></ul><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="DeployerOrAttacher.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Deployer.Or.Attacher))" x-target-lift="Figure"></a>Figure&nbsp;3: </span>The <code class="highlight"><font class="badlink"><span class="nx">DeployerOrAttacher</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AppViews.js#L56-L78">AppViews.DeployerOrAttacher</a></span></p></blockquote><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L37-L38"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="  selectAttacher() { this.setState({view: 'Wrapper', ContentView: Attacher}); }
  selectDeployer() { this.setState({view: 'Wrapper', ContentView: Deployer}); }"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">37</span>      <font class="badlink"><span class="nx">selectAttacher</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Wrapper&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">ContentView</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">Attacher</span></font><span class="p">});</span> <span class="p">}</span>
<span class="mf">38</span>      <font class="badlink"><span class="nx">selectDeployer</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Wrapper&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">ContentView</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">Deployer</span></font><span class="p">});</span> <span class="p">}</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>On lines 37 and 38, we set a sub-component
based on whether the user clicks <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Deployer</span><span class="hspace"></span></span> or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Attacher</span><span class="hspace"></span></span>.</p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">Next, we will define <code class="highlight"><font class="badlink"><span class="nx">Player</span></font></code> as a React component,
which will be extended by the specialized components for Alice and Bob.</div></p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="GetHand.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Get.Hand))" x-target-lift="Figure"></a>Figure&nbsp;4: </span>The <code class="highlight"><font class="badlink"><span class="nx">GetHand</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/PlayerViews.js#L8-L32">PlayerViews.GetHand</a></span></p></blockquote><p>Our Web frontend needs to implement the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> for players, which we defined as:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.rsh#L20-L25"><span class="stt">tut-9/index.rsh</span></a><button class="btn" data-clipboard-text="const Player = {
  ...hasRandom,
  getHand: Fun([], UInt),
  seeOutcome: Fun([UInt], Null),
  informTimeout: Fun([], Null),
};"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mi">20</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">Player</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">21</span>      <span class="p">...</span><a href="ref-programs-compute.html#%28reach._%28%28has.Random%29%29%29" class="nb" data-pltdoc="x">hasRandom</a><span class="p">,</span>
<span class="mi">22</span>      <font class="badlink"><span class="nx">getHand</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([],</span> <a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">),</span>
<span class="mi">23</span>      <font class="badlink"><span class="nx">seeOutcome</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Null%29%29%29" class="nb" data-pltdoc="x">Null</a><span class="p">),</span>
<span class="mi">24</span>      <font class="badlink"><span class="nx">informTimeout</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Null%29%29%29" class="nb" data-pltdoc="x">Null</a><span class="p">),</span>
<span class="mi">25</span>    <span class="p">};</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>We will provide these callbacks via the React component directly.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L42-L55"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="class Player extends React.Component {
  random() { return reach.hasRandom.random(); }
  async getHand() { // Fun([], UInt)
    const hand = await new Promise(resolveHandP =&gt; {
      this.setState({view: 'GetHand', playable: true, resolveHandP});
    });
    this.setState({view: 'WaitingForResults', hand});
    return handToInt[hand];
  }
  seeOutcome(i) { this.setState({view: 'Done', outcome: intToOutcome[i]}); }
  informTimeout() { this.setState({view: 'Timeout'}); }
  playHand(hand) { this.state.resolveHandP(hand); }
}
"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">42</span>    <font class="badlink"><span class="kd">class</span></font> <font class="badlink"><span class="nx">Player</span></font> <font class="badlink"><span class="k">extends</span></font> <font class="badlink"><span class="nx">React</span></font><span class="p">.</span><font class="badlink"><span class="nx">Component</span></font> <span class="p">{</span>
<span class="mf">43</span>      <font class="badlink"><span class="nx">random</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><font class="badlink"><span class="nx">hasRandom</span></font><span class="p">.</span><font class="badlink"><span class="nx">random</span></font><span class="p">();</span> <span class="p">}</span>
<span class="mf">44</span>      <font class="badlink"><span class="k">async</span></font> <font class="badlink"><span class="nx">getHand</span></font><span class="p">()</span> <span class="p">{</span> <span class="c1">// Fun([], UInt)</span>
<span class="mf">45</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">hand</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">await</span></font> <font class="badlink"><span class="k">new</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">(</span><font class="badlink"><span class="nx">resolveHandP</span></font> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="mf">46</span>          <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;GetHand&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">playable</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="kc">true</span></font><span class="p">,</span> <font class="badlink"><span class="nx">resolveHandP</span></font><span class="p">});</span>
<span class="mf">47</span>        <span class="p">});</span>
<span class="mf">48</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;WaitingForResults&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">hand</span></font><span class="p">});</span>
<span class="mf">49</span>        <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">handToInt</span></font><span class="p">[</span><font class="badlink"><span class="nx">hand</span></font><span class="p">];</span>
<span class="mf">50</span>      <span class="p">}</span>
<span class="mf">51</span>      <font class="badlink"><span class="nx">seeOutcome</span></font><span class="p">(</span><font class="badlink"><span class="nx">i</span></font><span class="p">)</span> <span class="p">{</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Done&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">outcome</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">intToOutcome</span></font><span class="p">[</span><font class="badlink"><span class="nx">i</span></font><span class="p">]});</span> <span class="p">}</span>
<span class="mf">52</span>      <font class="badlink"><span class="nx">informTimeout</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Timeout&#39;</span><span class="p">});</span> <span class="p">}</span>
<span class="mf">53</span>      <font class="badlink"><span class="nx">playHand</span></font><span class="p">(</span><font class="badlink"><span class="nx">hand</span></font><span class="p">)</span> <span class="p">{</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">resolveHandP</span></font><span class="p">(</span><font class="badlink"><span class="nx">hand</span></font><span class="p">);</span> <span class="p">}</span>
<span class="mf">54</span>    <span class="p">}</span>
<span class="mf">55</span>    
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 43, we provide the <code class="highlight"><font class="badlink"><span class="nx">random</span></font></code> callback</p></li><li><p>On lines 44 thru 50, we provide the <code class="highlight"><font class="badlink"><span class="nx">getHand</span></font></code> callback.</p></li><li><p>On lines 45 thru 47, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">GetHand</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Get.Hand%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">4</span></a>),
and wait for a <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> which can be resolved via user interaction.</p></li><li><p>On line 48, which occurs after the <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> is resolved,
we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">WaitingForResults</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Waiting.For.Results%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">5</span></a>).</p></li><li><p>On lines 51 and 52, we provide the <code class="highlight"><font class="badlink"><span class="nx">seeOutcome</span></font></code> and <code class="highlight"><font class="badlink"><span class="nx">informTimeout</span></font></code> callbacks,
which set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Done</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Done%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">6</span></a>) and the <code class="highlight"><font class="badlink"><span class="nx">Timeout</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Timeout%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">7</span></a>), respectively.</p></li><li><p>On line 53, we define what happens when the user clicks <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Rock</span><span class="hspace"></span></span>, <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Paper</span><span class="hspace"></span></span>, or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Scissors</span><span class="hspace"></span></span>:
The <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> from line 45 is resolved.</p></li></ul><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="WaitingForResults.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Waiting.For.Results))" x-target-lift="Figure"></a>Figure&nbsp;5: </span>The <code class="highlight"><font class="badlink"><span class="nx">WaitingForResults</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/PlayerViews.js#L34-L42">PlayerViews.WaitingForResults</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Done.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Done))" x-target-lift="Figure"></a>Figure&nbsp;6: </span>The <code class="highlight"><font class="badlink"><span class="nx">Done</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/PlayerViews.js#L44-L54">PlayerViews.Done</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Timeout.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Timeout))" x-target-lift="Figure"></a>Figure&nbsp;7: </span>The <code class="highlight"><font class="badlink"><span class="nx">Timeout</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/PlayerViews.js#L56-L64">PlayerViews.Timeout</a></span></p></blockquote></div></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">Next, we will define <code class="highlight"><font class="badlink"><span class="nx">Deployer</span></font></code> as a React component for Alice,
which extends <code class="highlight"><font class="badlink"><span class="nx">Player</span></font></code>.</div></p><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="SetWager.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Set.Wager))" x-target-lift="Figure"></a>Figure&nbsp;8: </span>The <code class="highlight"><font class="badlink"><span class="nx">SetWager</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/DeployerViews.js#L20-L38">DeployerViews.SetWager</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Deploy.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Deploy))" x-target-lift="Figure"></a>Figure&nbsp;9: </span>The <code class="highlight"><font class="badlink"><span class="nx">Deploy</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/DeployerViews.js#L40-L53">DeployerViews.Deploy</a></span></p></blockquote></div></p><p>Our Web frontend needs to implement the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> for Alice, which we defined as:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.rsh#L28-L32"><span class="stt">tut-9/index.rsh</span></a><button class="btn" data-clipboard-text="  const Alice = Participant('Alice', {
    ...Player,
    wager: UInt, // atomic units of currency
    deadline: UInt, // time delta (blocks/rounds)
  });"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mi">28</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">Alice</span></font> <font class="badlink"><span class="o">=</span></font> <a href="ref-programs-appinit.html#%28reach._%28%28.Participant%29%29%29" class="nb" data-pltdoc="x">Participant</a><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="p">{</span>
<span class="mi">29</span>        <span class="p">...</span><font class="badlink"><span class="nx">Player</span></font><span class="p">,</span>
<span class="mi">30</span>        <font class="badlink"><span class="nx">wager</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">,</span> <span class="c1">// atomic units of currency</span>
<span class="mi">31</span>        <font class="badlink"><span class="nx">deadline</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">,</span> <span class="c1">// time delta (blocks/rounds)</span>
<span class="mi">32</span>      <span class="p">});</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>We will provide the <code class="highlight"><font class="badlink"><span class="nx">wager</span></font></code> and <code class="highlight"><font class="badlink"><span class="nx">deadline</span></font></code> values,
and define some button handlers in order to trigger the deployment of the contract.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L56-L72"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="class Deployer extends Player {
  constructor(props) {
    super(props);
    this.state = {view: 'SetWager'};
  }
  setWager(wager) { this.setState({view: 'Deploy', wager}); }
  async deploy() {
    const ctc = this.props.acc.deploy(backend);
    this.setState({view: 'Deploying', ctc});
    this.wager = reach.parseCurrency(this.state.wager); // UInt
    this.deadline = {ETH: 10, ALGO: 100, CFX: 1000}[reach.connector]; // UInt
    backend.Alice(ctc, this);
    const ctcInfoStr = JSON.stringify(await ctc.getInfo(), null, 2);
    this.setState({view: 'WaitingForAttacher', ctcInfoStr});
  }
  render() { return renderView(this, DeployerViews); }
}"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">56</span>    <font class="badlink"><span class="kd">class</span></font> <font class="badlink"><span class="nx">Deployer</span></font> <font class="badlink"><span class="k">extends</span></font> <font class="badlink"><span class="nx">Player</span></font> <span class="p">{</span>
<span class="mf">57</span>      <font class="badlink"><span class="nx">constructor</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mf">58</span>        <font class="badlink"><span class="k">super</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">);</span>
<span class="mf">59</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;SetWager&#39;</span><span class="p">};</span>
<span class="mf">60</span>      <span class="p">}</span>
<span class="mf">61</span>      <font class="badlink"><span class="nx">setWager</span></font><span class="p">(</span><font class="badlink"><span class="nx">wager</span></font><span class="p">)</span> <span class="p">{</span> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Deploy&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">wager</span></font><span class="p">});</span> <span class="p">}</span>
<span class="mf">62</span>      <font class="badlink"><span class="k">async</span></font> <a href="ref-frontends-js-ctc.html#%28javascript._%28%28deploy%29%29%29" class="nx" data-pltdoc="x">deploy</a><span class="p">()</span> <span class="p">{</span>
<span class="mf">63</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">ctc</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">props</span></font><span class="p">.</span><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><a href="ref-frontends-js-ctc.html#%28javascript._%28%28deploy%29%29%29" class="nx" data-pltdoc="x">deploy</a><span class="p">(</span><a href="ref-backends-js.html#%28javascript._%28%28backend%29%29%29" class="nx" data-pltdoc="x">backend</a><span class="p">);</span>
<span class="mf">64</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Deploying&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">ctc</span></font><span class="p">});</span>
<span class="mf">65</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">wager</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-utils.html#%28javascript._%28%28parse.Currency%29%29%29" class="nx" data-pltdoc="x">parseCurrency</a><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">wager</span></font><span class="p">);</span> <span class="c1">// UInt</span>
<span class="mf">66</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">deadline</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span><font class="badlink"><span class="nx">ETH</span></font><font class="badlink"><span class="o">:</span></font> <span class="mf">10</span><span class="p">,</span> <font class="badlink"><span class="nx">ALGO</span></font><font class="badlink"><span class="o">:</span></font> <span class="mf">100</span><span class="p">,</span> <font class="badlink"><span class="nx">CFX</span></font><font class="badlink"><span class="o">:</span></font> <span class="mf">1000</span><span class="p">}[</span><font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-network.html#%28javascript._%28%28connector%29%29%29" class="nx" data-pltdoc="x">connector</a><span class="p">];</span> <span class="c1">// UInt</span>
<span class="mf">67</span>        <a href="ref-backends-js.html#%28javascript._%28%28backend%29%29%29" class="nx" data-pltdoc="x">backend</a><span class="p">.</span><font class="badlink"><span class="nx">Alice</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctc</span></font><span class="p">,</span> <font class="badlink"><span class="k">this</span></font><span class="p">);</span>
<span class="mf">68</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">ctcInfoStr</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">JSON</span></font><span class="p">.</span><font class="badlink"><span class="nx">stringify</span></font><span class="p">(</span><font class="badlink"><span class="k">await</span></font> <font class="badlink"><span class="nx">ctc</span></font><span class="p">.</span><a href="ref-frontends-js-ctc.html#%28javascript._%28%28get.Info%29%29%29" class="nx" data-pltdoc="x">getInfo</a><span class="p">(),</span> <font class="badlink"><span class="kc">null</span></font><span class="p">,</span> <span class="mf">2</span><span class="p">);</span>
<span class="mf">69</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;WaitingForAttacher&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">ctcInfoStr</span></font><span class="p">});</span>
<span class="mf">70</span>      <span class="p">}</span>
<span class="mf">71</span>      <font class="badlink"><span class="nx">render</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">renderView</span></font><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">,</span> <font class="badlink"><span class="nx">DeployerViews</span></font><span class="p">);</span> <span class="p">}</span>
<span class="mf">72</span>    <span class="p">}</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 59, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">SetWager</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Set.Wager%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">8</span></a>).</p></li><li><p>On line 61, we define what to do when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Set Wager</span><span class="hspace"></span></span> button,
which is to set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Deploy</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Deploy%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">9</span></a>).</p></li><li><p>On lines 62 thru 69, we define what to do when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Deploy</span><span class="hspace"></span></span> button.</p></li><li><p>On line 63, we call <code class="highlight"><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><a href="ref-frontends-js-ctc.html#%28javascript._%28%28deploy%29%29%29" class="nx" data-pltdoc="x">deploy</a></code>, which triggers a deploy of the contract.</p></li><li><p>On line 64, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Deploying</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Deploying%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">10</span></a>).</p></li><li><p>On line 65, we set the <code class="highlight"><font class="badlink"><span class="nx">wager</span></font></code> property.</p></li><li><p>On line 66, we set the <code class="highlight"><font class="badlink"><span class="nx">deadline</span></font></code> property based on which connector is being used.</p></li><li><p>On line 67, we start running the Reach program as Alice, using the <code class="highlight"><font class="badlink"><span class="k">this</span></font></code> React component
as the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> object.</p></li><li><p>On lines 68 and 69, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">WaitingForAttacher</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Waiting.For.Attacher%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">11</span></a>),
which displays the deployed contract info as JSON.</p></li><li><p>On line 71, we render the appropriate view from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/DeployerViews.js"><span class="stt">tut-9/views/DeployerViews.js</span></a>.</p></li></ul><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Deploying.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Deploying))" x-target-lift="Figure"></a>Figure&nbsp;10: </span>The <code class="highlight"><font class="badlink"><span class="nx">Deploying</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/DeployerViews.js#L55-L61">DeployerViews.Deploying</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="WaitingForAttacher.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Waiting.For.Attacher))" x-target-lift="Figure"></a>Figure&nbsp;11: </span>The <code class="highlight"><font class="badlink"><span class="nx">WaitingForAttacher</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/DeployerViews.js#L63-L90">DeployerViews.WaitingForAttacher</a></span></p></blockquote></div></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Attach.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Attach))" x-target-lift="Figure"></a>Figure&nbsp;12: </span>The <code class="highlight"><font class="badlink"><span class="nx">Attach</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AttacherViews.js#L18-L39">AttacherViews.Attach</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Attaching.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Attaching))" x-target-lift="Figure"></a>Figure&nbsp;13: </span>The <code class="highlight"><font class="badlink"><span class="nx">Attaching</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AttacherViews.js#L41-L49">AttacherViews.Attaching</a></span></p></blockquote></div></p><p>Our Web frontend needs to implement the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> for Bob, which we defined as:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.rsh#L33-L36"><span class="stt">tut-9/index.rsh</span></a><button class="btn" data-clipboard-text="  const Bob   = Participant('Bob', {
    ...Player,
    acceptWager: Fun([UInt], Null),
  });"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mi">33</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">Bob</span></font>   <font class="badlink"><span class="o">=</span></font> <a href="ref-programs-appinit.html#%28reach._%28%28.Participant%29%29%29" class="nb" data-pltdoc="x">Participant</a><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="p">{</span>
<span class="mi">34</span>        <span class="p">...</span><font class="badlink"><span class="nx">Player</span></font><span class="p">,</span>
<span class="mi">35</span>        <font class="badlink"><span class="nx">acceptWager</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Null%29%29%29" class="nb" data-pltdoc="x">Null</a><span class="p">),</span>
<span class="mi">36</span>      <span class="p">});</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>We will provide the <code class="highlight"><font class="badlink"><span class="nx">acceptWager</span></font></code> callback,
and define some button handlers in order to attach to the deployed contract.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L73-L95"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="class Attacher extends Player {
  constructor(props) {
    super(props);
    this.state = {view: 'Attach'};
  }
  attach(ctcInfoStr) {
    const ctc = this.props.acc.attach(backend, JSON.parse(ctcInfoStr));
    this.setState({view: 'Attaching'});
    backend.Bob(ctc, this);
  }
  async acceptWager(wagerAtomic) { // Fun([UInt], Null)
    const wager = reach.formatCurrency(wagerAtomic, 4);
    return await new Promise(resolveAcceptedP =&gt; {
      this.setState({view: 'AcceptTerms', wager, resolveAcceptedP});
    });
  }
  termsAccepted() {
    this.state.resolveAcceptedP();
    this.setState({view: 'WaitingForTurn'});
  }
  render() { return renderView(this, AttacherViews); }
}
"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">73</span>    <font class="badlink"><span class="kd">class</span></font> <font class="badlink"><span class="nx">Attacher</span></font> <font class="badlink"><span class="k">extends</span></font> <font class="badlink"><span class="nx">Player</span></font> <span class="p">{</span>
<span class="mf">74</span>      <font class="badlink"><span class="nx">constructor</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mf">75</span>        <font class="badlink"><span class="k">super</span></font><span class="p">(</span><font class="badlink"><span class="nx">props</span></font><span class="p">);</span>
<span class="mf">76</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Attach&#39;</span><span class="p">};</span>
<span class="mf">77</span>      <span class="p">}</span>
<span class="mf">78</span>      <a href="ref-frontends-js-ctc.html#%28javascript._%28%28attach%29%29%29" class="nx" data-pltdoc="x">attach</a><span class="p">(</span><font class="badlink"><span class="nx">ctcInfoStr</span></font><span class="p">)</span> <span class="p">{</span>
<span class="mf">79</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">ctc</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">props</span></font><span class="p">.</span><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><a href="ref-frontends-js-ctc.html#%28javascript._%28%28attach%29%29%29" class="nx" data-pltdoc="x">attach</a><span class="p">(</span><a href="ref-backends-js.html#%28javascript._%28%28backend%29%29%29" class="nx" data-pltdoc="x">backend</a><span class="p">,</span> <font class="badlink"><span class="nx">JSON</span></font><span class="p">.</span><font class="badlink"><span class="nx">parse</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctcInfoStr</span></font><span class="p">));</span>
<span class="mf">80</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;Attaching&#39;</span><span class="p">});</span>
<span class="mf">81</span>        <a href="ref-backends-js.html#%28javascript._%28%28backend%29%29%29" class="nx" data-pltdoc="x">backend</a><span class="p">.</span><font class="badlink"><span class="nx">Bob</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctc</span></font><span class="p">,</span> <font class="badlink"><span class="k">this</span></font><span class="p">);</span>
<span class="mf">82</span>      <span class="p">}</span>
<span class="mf">83</span>      <font class="badlink"><span class="k">async</span></font> <font class="badlink"><span class="nx">acceptWager</span></font><span class="p">(</span><font class="badlink"><span class="nx">wagerAtomic</span></font><span class="p">)</span> <span class="p">{</span> <span class="c1">// Fun([UInt], Null)</span>
<span class="mf">84</span>        <font class="badlink"><span class="kd">const</span></font> <font class="badlink"><span class="nx">wager</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">reach</span></font><span class="p">.</span><a href="ref-frontends-js-utils.html#%28javascript._%28%28format.Currency%29%29%29" class="nx" data-pltdoc="x">formatCurrency</a><span class="p">(</span><font class="badlink"><span class="nx">wagerAtomic</span></font><span class="p">,</span> <span class="mf">4</span><span class="p">);</span>
<span class="mf">85</span>        <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="k">await</span></font> <font class="badlink"><span class="k">new</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">(</span><font class="badlink"><span class="nx">resolveAcceptedP</span></font> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="mf">86</span>          <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;AcceptTerms&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">wager</span></font><span class="p">,</span> <font class="badlink"><span class="nx">resolveAcceptedP</span></font><span class="p">});</span>
<span class="mf">87</span>        <span class="p">});</span>
<span class="mf">88</span>      <span class="p">}</span>
<span class="mf">89</span>      <font class="badlink"><span class="nx">termsAccepted</span></font><span class="p">()</span> <span class="p">{</span>
<span class="mf">90</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">state</span></font><span class="p">.</span><font class="badlink"><span class="nx">resolveAcceptedP</span></font><span class="p">();</span>
<span class="mf">91</span>        <font class="badlink"><span class="k">this</span></font><span class="p">.</span><font class="badlink"><span class="nx">setState</span></font><span class="p">({</span><font class="badlink"><span class="nx">view</span></font><font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;WaitingForTurn&#39;</span><span class="p">});</span>
<span class="mf">92</span>      <span class="p">}</span>
<span class="mf">93</span>      <font class="badlink"><span class="nx">render</span></font><span class="p">()</span> <span class="p">{</span> <font class="badlink"><span class="k">return</span></font> <font class="badlink"><span class="nx">renderView</span></font><span class="p">(</span><font class="badlink"><span class="k">this</span></font><span class="p">,</span> <font class="badlink"><span class="nx">AttacherViews</span></font><span class="p">);</span> <span class="p">}</span>
<span class="mf">94</span>    <span class="p">}</span>
<span class="mf">95</span>    
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><ul><li><p>On line 76, we initialize the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Attach</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Attach%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">12</span></a>).</p></li><li><p>On lines 78 thru 82, we define what happens when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Attach</span><span class="hspace"></span></span> button.</p></li><li><p>On line 79, we call <code class="highlight"><font class="badlink"><span class="nx">acc</span></font><span class="p">.</span><a href="ref-frontends-js-ctc.html#%28javascript._%28%28attach%29%29%29" class="nx" data-pltdoc="x">attach</a></code></p></li><li><p>On line 80, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">Attaching</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Attaching%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">13</span></a>).</p></li><li><p>On line 81, we start running the Reach program as Bob, using the <code class="highlight"><font class="badlink"><span class="k">this</span></font></code> React component
as the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> object.</p></li><li><p>On lines 83 thru 88, we define the <code class="highlight"><font class="badlink"><span class="nx">acceptWager</span></font></code> callback.</p></li><li><p>On lines 85 thru 87, we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">AcceptTerms</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Accept.Terms%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">14</span></a>),
and wait for a <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> which can be resolved via user interaction.</p></li><li><p>On lines 89 thru 92, we define what happens when the user clicks the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">Accept Terms and Pay Wager</span><span class="hspace"></span></span> button:
the <code class="highlight"><font class="badlink"><span class="nb">Promise</span></font></code> from line 90 is resolved, and we set the component state to display the <code class="highlight"><font class="badlink"><span class="nx">WaitingForTurn</span></font></code> view (<a href="#%28counter._%28figure._fig~3atut-9%2Fviews%2F.Waiting.For.Turn%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">15</span></a>).</p></li><li><p>On line 93, we render the approprite view from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AttacherViews.js"><span class="stt">tut-9/views/AttacherViews.js</span></a></p></li></ul><p><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="AcceptTerms.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Accept.Terms))" x-target-lift="Figure"></a>Figure&nbsp;14: </span>The <code class="highlight"><font class="badlink"><span class="nx">AcceptTerms</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AttacherViews.js#L51-L70">AttacherViews.AcceptTerms</a></span></p></blockquote></div><div class="SIntrapara"><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="WaitingForTurn.png" alt="" width="600" height="420"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atut-9/views/.Waiting.For.Turn))" x-target-lift="Figure"></a>Figure&nbsp;15: </span>The <code class="highlight"><font class="badlink"><span class="nx">WaitingForTurn</span></font></code> view. See: <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/AttacherViews.js#L72-L81">AttacherViews.WaitingForTurn</a></span></p></blockquote></div></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/index.js#L96-L96"><span class="stt">tut-9/index.js</span></a><button class="btn" data-clipboard-text="renderDOM(&lt;App /&gt;);"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
<span class="mf">96</span>    <font class="badlink"><span class="nx">renderDOM</span></font><span class="p">(</span><font class="badlink"><span class="o">&lt;</span></font><font class="badlink"><span class="nx">App</span></font> <font class="badlink"><span class="o">/&gt;</span></font><span class="p">);</span>
</pre></div></div></p><p>Finally, we call a small helper function from <a href="https://github.com/reach-sh/reach-lang/blob/master/examples/tut-9/views/render.js"><span class="stt">tut-9/views/render.js</span></a>
to render our App component.</p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">As a convenience for running the React development server,
you can call:</div></p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">./reach react</span></p><p><span style="font-weight: bold">&#8212;<wbr></wbr></span></p><p>To run the React development server with Algorand,
you can call:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">REACH_CONNECTOR_MODE=ALGO ./reach react</span></p><p>Similarly, to run with Conflux:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">REACH_CONNECTOR_MODE=CFX ./reach react</span></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">If you&rsquo;d like to instead use Reach in your own JavaScript project,
you can call:</div></p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">npm install @reach-sh/stdlib</span></p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The Reach standard library is undergoing continual improvement and is updated often.
If you are experiencing issues with the Node.js package, try updating!</p></blockquote></blockquote></blockquote><p>As usual, you can compile your Reach program <span class="RktInBG"><span class="hspace"></span><span class="RktIn">index.rsh</span><span class="hspace"></span></span> to the <code class="highlight"><a href="ref-backends-js.html#%28javascript._%28%28backend%29%29%29" class="nx" data-pltdoc="x">backend</a></code> build artifact <span class="RktInBG"><span class="hspace"></span><span class="RktIn">build/index.main.mjs</span><span class="hspace"></span></span> with:</p><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">./reach compile</span></p><p><div class="SIntrapara"><span style="font-weight: bold">&#8212;<wbr></wbr></span></div><div class="SIntrapara">Now our implementation of <span class="emph">Rock, Paper, Scissors!</span> is live in the browser!
We can leverage callbacks in the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> to display to and gather information from the user,
through any Web UI framework of our choice.</div></p><p>If we wanted to deploy this application to the world, then we would take the static files that React produces and host them on a Web server.
These files embed your compiled Reach program, so there&rsquo;s nothing more to do than provide them to the world.</p><p>In <a href="tut-10.html" data-pltdoc="x">the next section</a>, we&rsquo;ll summarize where we&rsquo;ve gone and direct you to the next step of your journey to decentralized application mastery.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><div class="SIntrapara">Check your understanding: True or false: Reach integrates with all Web interface libraries, like React, Vue, and so on, because Reach frontends are just normal JavaScript programs. </div><div class="SIntrapara"><blockquote class="check-answer"><p><div class="SIntrapara">Answer: </div><div class="SIntrapara"><p class="check-answer-body">True</p></div></p></blockquote></div></p></blockquote></blockquote></blockquote><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><div class="SIntrapara">Check your understanding: True or false: Reach accelerates your development with React by baking-in a React development server and the deployment process to test React programs locally. </div><div class="SIntrapara"><blockquote class="check-answer"><p><div class="SIntrapara">Answer: </div><div class="SIntrapara"><p class="check-answer-body">True</p></div></p></blockquote></div></p></blockquote></blockquote></blockquote><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search docs..." title="Enter a search string to search the Reach documentation" onkeypress="return reach_DoSearch(event, this);"></form>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tut-8.html" title="backward to &quot;2.8 Interaction and Independence&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="tut.html" title="up to &quot;2 Tutorial&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="tut-10.html" title="forward to &quot;2.10 Onward and Further&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div><script src="reach-post.js"></script></body></html>